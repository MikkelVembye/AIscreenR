[{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"loading-relevant-ris-file-data-for-screening","dir":"Articles","previous_headings":"","what":"Loading relevant ris file data for screening","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"","code":"# Loading packages  library(AIscreenR) library(revtools) library(tibble) library(dplyr) library(purrr) library(usethis) library(future)   # Loading excluded studies # Consider making AIscreenR_example function as https://github.com/tidyverse/readxl/blob/HEAD/R/example.R  excl_path <- system.file(\"extdata\", \"excl_tutorial.ris\", package = \"AIscreenR\") ris_dat_excl <- revtools::read_bibliography(excl_path) |>    suppressWarnings() |>    as_tibble() |>   select(author, eppi_id, title, abstract) |> # Using only relevant variables   mutate(     human_code = 0   )  # Loading included studies incl_path <- system.file(\"extdata\", \"incl_tutorial.ris\", package = \"AIscreenR\") ris_dat_incl <- revtools::read_bibliography(incl_path) |>    suppressWarnings() |>    as_tibble() |>   select(author, eppi_id, title, abstract) |>   mutate(     human_code = 1   )  # Check why filges2015_data and filges2015_dat differs  filges2015_dat <-    bind_rows(ris_dat_excl, ris_dat_incl) |>    mutate(     studyid = 1:n()   ) |>    relocate(studyid, .after = eppi_id)  #?filges2015_dat filges2015_dat #> # A tibble: 150 × 6 #>    author                              eppi_id studyid title abstract human_code #>    <chr>                               <chr>     <int> <chr> <chr>         <dbl> #>  1 Holloway R G and Gramling R and Ke… 9434957       1 Esti… \"Progno…          0 #>  2 Morawska Alina and Stallman Helen … 9433838       2 Self… \"Behavi…          0 #>  3 Michel C M and Pascual-Marqui R D … 9431171       3 Freq… \"The to…          0 #>  4 Paul Howard A                       9433968       4 A Re… \"The ar…          0 #>  5 Feinberg I and De Bie E and Davis … 9434460       5 Topo… \"STUDY …          0 #>  6 Hamburg Sam R                       9433554       6 BOOK… \"The ar…          0 #>  7 Park H Y and Lee B J and Kim J H a… 9435130       7 Rapi… \"Backgr…          0 #>  8 Petrek J                            9432040       8 Pict… \"AIMS: …          0 #>  9 Schwartzman Meredith P and Wahler … 9434093       9 Enha… \"New an…          0 #> 10 Faber J and Srutova L and Pilarova… 9431505      10 EEG … \"Sponta…          0 #> # ℹ 140 more rows"},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"getting-api-key-openai","dir":"Articles","previous_headings":"","what":"Getting API key OpenAI","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"can use function AIscreenR, must generate secret API key. must first ensure created account OpenAI (done stage, can sign ). account, go https://platform.openai.com/account/api-keys press + Create new secret key button (see picture ) give key name.     generate secret API key, remember store safely since able see . NOTE: lose API key, can just generate new one.","code":""},{"path":[]},{"path":[]},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"pemanent-solution","dir":"Articles","previous_headings":"Handling your API key with AIscreenR","what":"Pemanent solution","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"add API key permanently environment variables, can execute usethis::edit_r_environ().     entering API key, save .Renviron document restart RStudio (ctrl + shift + F10).","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"retrieve-rate-limit-information","dir":"Articles","previous_headings":"","what":"Retrieve rate limit information","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"","code":"# Rate limits across one model (Default is \"gpt-3.5-turbo-0613\") rate_limits <- rate_limits_per_minute() rate_limits #> # A tibble: 1 × 3 #>   model              requests_per_minute tokens_per_minute #>   <chr>                            <dbl>             <dbl> #> 1 gpt-3.5-turbo-0613                3500             90000   # Rate limits overview across multiple models models <- c(\"gpt-3.5-turbo-0613\", \"gpt-4\") models_rate_limits <- rate_limits_per_minute(model = models) # Add further models if necessary models_rate_limits #> # A tibble: 2 × 3 #>   model              requests_per_minute tokens_per_minute #>   <chr>                            <dbl>             <dbl> #> 1 gpt-3.5-turbo-0613                3500             90000 #> 2 gpt-4                              200             10000"},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"approximate-price-of-screening","dir":"Articles","previous_headings":"","what":"Approximate price of screening","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"Example enter prompt. Can also done word         Approximate price screening","code":"prompt <- \"Evaluate the following study based on the selection criteria for a systematic review on the effects of family-based interventions on drug  abuse reduction for young people in treatment for non-opioid drug use. A family-based intervention (FFT) is equivalent to a behavior focused family therapy, where young people’s drug use is understood in relation to  family behavior problems. Family-based interventions also includes manual-based  family therapies as it targets young people and their families as a system  throughout treatment, and thereby recognizes the important role of the family  system in the development and treatment of young people’s drug use problems.  FFT was developed in the late 1980s on request from the US National Institute on Drug Abuse (NIDA). The development of FFT was initially heavily inspired by the  alcohol abuse program Community Reinforcement Approach (CRA), which was aimed  at restructuring the environment to reinforce non-alcohol associated activities.  FFT developed to have more emphasis on contingency contracting, impulse control  strategies specific to drug use, and increased emphasis on involvement of family  members in treatment. FFT is designed to accommodate diverse populations of  youths with a variety of behavioral, cultural and individual preferences.  FFT has evolved for use in severe behavioral disturbances known to co-exist with substance use and dependence, and the core interventions have been enhanced to  address several mental health related problems commonly occurring as comorbid conditions in drug use treatment participant.  For each study, I would like you to assess:  1) Is the study about a family-based intervention, such as Functional Family Therapy, Multidimensional Family Therapy, or Behavioral Family Therapy? (Outpatient manual-based interventions of any duration delivered to young people and their families). If not, exclude study. 2) Are the participants in outpatient drug treatment primarily for non-opioid drug use? 3) Are the participants within age 11–21?\" word_path1 <-  system.file(\"extdata\", \"word_pormpt_1.docx\", package = \"AIscreenR\")  prompt_word <-    readtext::readtext(word_path1)$text |>        stringr::str_remove_all(\"\\n\")  str(prompt_word) #>  chr \"Evaluate the following study based on the selection criteria for a systematic review on the effects of family-b\"| __truncated__  # Working with multiple prompts word_paths <- system.file(\"extdata\", c(\"word_pormpt_1.docx\", \"word_pormpt_2.docx\"), package = \"AIscreenR\")  prompt_word2 <-    purrr::map_chr(     word_paths, ~ {       readtext::readtext(.x)$text |>          stringr::str_remove_all(\"\\n\")     }    )  str(prompt_word2) #>  chr [1:2] \"Evaluate the following study based on the selection criteria for a systematic review on the effects of family-b\"| __truncated__ ... reps <- c(10, 1)  app_obj <-    approximate_price_gpt(     data = filges2015_dat, # Tutorial data embedded in the package     prompt = prompt,      studyid = studyid, # indicate the variable with the studyid in the data     title = title, # indicate the variable with the titles in the data     abstract = abstract, # indicate the variable with the abstracts in the data     model = models,     reps = reps    )  app_obj #> The approximate price of the (simple) screening will be around $7.5449.  app_obj$price_dollar #> [1] 7.5449 app_obj$price_data #> # A tibble: 2 × 5 #>   model     iterations input_price_dollar output_price_dollar total_price_dollor #>   <chr>          <dbl>              <dbl>               <dbl>              <dbl> #> 1 gpt-3.5-…         10               2.47               0.033               2.50 #> 2 gpt-4              1               4.94               0.099               5.04"},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"screen-titles-and-abstracts","dir":"Articles","previous_headings":"","what":"Screen titles and abstracts","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"","code":"plan(multisession)  FFT_screen_obj <-    tabscreen_gpt(     data = filges2015_dat[c(1:2),],     prompt = prompt,     studyid = studyid, # indicate the variable with the studyid in the data     title = title, # indicate the variable with the titles in the data     abstract = abstract, # indicate the variable with the abstracts in the data,     model = models,     reps = reps   ) #> * The approximate price of the current (simple) screening will be around $0.0845. #>  Progress: ────────────────────────────────────────────────────────────────────────── 100%  plan(sequential)  FFT_screen_obj #> Find data with all answers by executing #>  object_name$answer_data_all  #>  #> Find data with the result aggregated across multiple answers by executing #>  object_name$answer_data_sum #>  #> Find total price for the screening by executing #>  object_name$price_dollor #>   #> If some requests failed, find the error data by executing #>  object_name$error_data"},{"path":"https://mikkelvembye.github.io/AIscreenR/articles/Using-ChatGPT-For-Screening.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Using ChatGPT for Title and Abstract Screening in Systematic Reviews","text":"Gartlehner, G., Wagner, G., Lux, L. et al. (2019). Assessing accuracy machine-assisted abstract screening DistillerAI: user study. Systematic Reviews. 8, 1-10. https://doi.org/10.1186/s13643-019-1221-3 Waffenschmidt, S., Knelangen, M., Sieben, W., Bühn, S., & Pieper, D. (2019). Single screening versus conventional double screening study selection systematic reviews: methodological systematic review. BMC Medical Research Methodology 19, 1-9. https://doi.org/10.1186/s12874-019-0782-0 Westgate MJ (2019). revtools: R package support article screening evidence synthesis. Research Synthesis Methods. doi:10.1002/jrsm.1374 https://doi.org/10.1002/jrsm.1374.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mikkel H. Vembye. Author, maintainer.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Vembye M (2023). AIscreenR: AI screening tools systematic reviews. R package version 0.0.0.9009, https://mikkelvembye.github.io/AIscreenR/.","code":"@Manual{,   title = {AIscreenR: AI screening tools for systematic reviews},   author = {Mikkel H. Vembye},   year = {2023},   note = {R package version 0.0.0.9009},   url = {https://mikkelvembye.github.io/AIscreenR/}, }"},{"path":"https://mikkelvembye.github.io/AIscreenR/index.html","id":"aiscreenr-ai-screening-tools-in-r-for-systematic-reviewing","dir":"","previous_headings":"","what":"AI screening tools for systematic reviews","title":"AI screening tools for systematic reviews","text":"goal AIscreenR use AI tools support screening processes (including title abstract screening) systematic reviews related literature reviews.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"AI screening tools for systematic reviews","text":"can install development version AIscreenR GitHub : Setting API key checking rate limits load ris files. example downloaded ris files EPPI-Reviewer. Example enter prompt. Can also done word (see vignette). Approximate price screening Example conduct simple screening, getting return 1 reference included, 0 excluded, 1.1 firm decision reached.","code":"# install.packages(\"devtools\") devtools::install_github(\"MikkelVembye/AIscreenR\") # Find your api key at https://platform.openai.com/account/api-keys  # Thereafter, either encrypt it with the secret functions from the httr2 package # see https://httr2.r-lib.org/reference/secrets.html or run set_api_key()  # and then enter you key. library(AIscreenR) library(revtools) library(tibble) library(dplyr)  # Setting API set_api_key(AIscreenR:::testing_key_chatgpt())  # Obtain rate limits info (Default is \"gpt-3.5-turbo-0613\") rate_limits <- rate_limits_per_minute() rate_limits #> # A tibble: 1 × 3 #>   model              requests_per_minute tokens_per_minute #>   <chr>                            <dbl>             <dbl> #> 1 gpt-3.5-turbo-0613                3500             90000  # Obtain rate limits info across multiple models rate_limits <- rate_limits_per_minute(model = c(\"gpt-3.5-turbo-0613\", \"gpt-4\")) rate_limits #> # A tibble: 2 × 3 #>   model              requests_per_minute tokens_per_minute #>   <chr>                            <dbl>             <dbl> #> 1 gpt-3.5-turbo-0613                3500             90000 #> 2 gpt-4                              200             10000 # Loading ris file data via revtools ris_dat_excl <- revtools::read_bibliography(\"path/FFT_exclude.ris\") |>    suppressWarnings() |>    select(studyid = eppi_id, title, abstract) |>    as_tibble() |>    mutate(     human_code = 0 # Indicating exclusion   )  ris_dat_incl <- revtools::read_bibliography(\"path/FFT_include.ris\") |>    suppressWarnings() |>    select(studyid = eppi_id, title, abstract) |>    as_tibble() |>    mutate(     human_code = 1 # Indicating inclusion   )  FFT_dat <- bind_rows(ris_dat_excl, ris_dat_incl) head(FFT_dat, 10) #> # A tibble: 10 × 4 #>    studyid title                                             abstract human_code #>    <chr>   <chr>                                             <chr>         <dbl> #>  1 9434957 Estimating and communicating prognosis in advanc… \"Progno…          0 #>  2 9433838 Self-Directed Behavioral Family Intervention: Do… \"Behavi…          0 #>  3 9431171 Frequency domain source localization shows state… \"The to…          0 #>  4 9433968 A Review of: 'Kearney, C. A. (2010). Helping Chi… \"The ar…          0 #>  5 9434460 Topographic differences in the adolescent matura… \"STUDY …          0 #>  6 9433554 BOOK REVIEW                                       \"The ar…          0 #>  7 9435130 Rapid improvement of depression and quality of l… \"Backgr…          0 #>  8 9432040 Pictorial cognitive task solving and dynamics of… \"AIMS: …          0 #>  9 9434093 Enhancing the Impact of Parent Training Through … \"New an…          0 #> 10 9431505 EEG spectrum as information carrier               \"Sponta…          0 #> # A tibble: 10 × 4 #>    studyid title                                             abstract human_code #>    <chr>   <chr>                                             <chr>         <dbl> #>  1 9434957 Estimating and communicating prognosis in advanc… \"Progno…          0 #>  2 9433838 Self-Directed Behavioral Family Intervention: Do… \"Behavi…          0 #>  3 9431171 Frequency domain source localization shows state… \"The to…          0 #>  4 9433968 A Review of: 'Kearney, C. A. (2010). Helping Chi… \"The ar…          0 #>  5 9434460 Topographic differences in the adolescent matura… \"STUDY …          0 #>  6 9433554 BOOK REVIEW                                       \"The ar…          0 #>  7 9435130 Rapid improvement of depression and quality of l… \"Backgr…          0 #>  8 9432040 Pictorial cognitive task solving and dynamics of… \"AIMS: …          0 #>  9 9434093 Enhancing the Impact of Parent Training Through … \"New an…          0 #> 10 9431505 EEG spectrum as information carrier               \"Sponta…          0 prompt <- \"Evaluate the following study based on the selection criteria for a systematic review on the effects of family-based interventions on drug abuse reduction for young people in treatment for non-opioid drug use. A family-based intervention (FFT) is equivalent to a behavior focused family therapy, where young people’s drug use is understood in relation to family behavior problems. Family-based interventions also includes manual-based family therapies as it targets young people and their families as a system throughout treatment, and thereby recognizes the important role of the family system in the development and treatment of young people’s drug use problems. FFT was developed in the late 1980s on request from the US National Institute on Drug Abuse (NIDA). The development of FFT was initially heavily inspired by the alcohol abuse program Community Reinforcement Approach (CRA), which was aimed at restructuring the environment to reinforce non-alcohol associated activities. FFT developed to have more emphasis on contingency contracting, impulse control strategies specific to drug use, and increased emphasis on involvement of family members in treatment. FFT is designed to accommodate diverse populations of youths with a variety of behavioral, cultural and individual preferences. FFT has evolved for use in severe behavioral disturbances known to co-exist with substance use and dependence, and the core interventions have been enhanced to address several mental health related problems commonly occurring as comorbid conditions in drug use treatment participant.  For each study, I would like you to assess:  1) Is the study about a family-based intervention, such as Functional Family Therapy, Multidimensional Family Therapy, or Behavioral Family Therapy? (Outpatient manual-based interventions of any duration delivered to young people and their families). If not, exclude study. 2) Are the participants in outpatient drug treatment primarily for non-opioid drug use? 3) Are the participants within age 11–21?\" app_obj <-    approximate_price_gpt(     data = FFT_dat,     prompt = prompt,     studyid = studyid, # indicate the variable with the studyid in the data     title = title, # indicate the variable with the titles in the data     abstract = abstract, # indicate the variable with the abstracts in the data     model = c(\"gpt-3.5-turbo-0613\"),     rep = 10    )  app_obj #> The approximate price of the (simple) screening will be around $2.488.  app_obj$price_dollar #> [1] 2.488 app_obj$price_data #> # A tibble: 1 × 5 #>   model     iterations input_price_dollar output_price_dollar total_price_dollor #>   <chr>          <dbl>              <dbl>               <dbl>              <dbl> #> 1 gpt-3.5-…         10               2.46               0.033               2.49 # Subsetting the number of references to speed up the tutorial screening  test_obj <-    tabscreen_gpt(     data = FFT_dat[c(140:150),],     prompt = prompt,      studyid = studyid, # indicate the variable with the studyid in the data     title = title, # indicate the variable with the titles in the data     abstract = abstract, # indicate the variable with the abstracts in the data     model = c(\"gpt-3.5-turbo-0613\"),     reps = 2 # Number of times the same question is asked to ChatGPT   )  #> * The approximate price of the current (simple) screening will be around $0.0286. #> * Consider removing references that has no abstract since these can distort the accuracy of the screening  test_obj #> Find data with all answers by executing #>  object_name$answer_data_all  #>  #> Find data with the result aggregated across multiple answers by executing #>  object_name$answer_data_sum #>  #> Find total price for the screening by executing #>  object_name$price_dollor  # Data sets in object price_dat <- test_obj$price_dat price_dat #> # A tibble: 1 × 4 #>   model              input_price_dollar output_price_dollar price_total_dollar #>   <chr>                           <dbl>               <dbl>              <dbl> #> 1 gpt-3.5-turbo-0613             0.0263             0.00052             0.0268   all_dat <- test_obj$answer_data_all all_dat |> select(decision_gpt:n) #> # A tibble: 22 × 6 #>    decision_gpt decision_binary prompt_tokens completion_tokens run_time     n #>    <chr>                  <dbl>         <int>             <int>    <dbl> <int> #>  1 1                          1          1027                11      0.7     1 #>  2 0                          0          1027                11      0.7     2 #>  3 1.1                        1           535                13      0.9     1 #>  4 1.1                        1           535                13      0.8     2 #>  5 1.1                        1           528                13      0.8     1 #>  6 1.1                        1           528                13      0.8     2 #>  7 1                          1          1141                11      0.9     1 #>  8 1.1                        1          1141                13      1.1     2 #>  9 1                          1           833                11      0.8     1 #> 10 1                          1           833                11      0.6     2 #> # ℹ 12 more rows   sum_dat <- test_obj$answer_data_sum sum_dat |> select(incl_p:n_mis_answers) #> # A tibble: 11 × 5 #>    incl_p final_decision_gpt final_decision_gpt_num  reps n_mis_answers #>     <dbl> <chr>                               <dbl> <int>         <int> #>  1    0.5 Include                                 1     2             0 #>  2    1   Include                                 1     2             0 #>  3    1   Include                                 1     2             0 #>  4    1   Include                                 1     2             0 #>  5    1   Include                                 1     2             0 #>  6    1   Include                                 1     2             0 #>  7    1   Include                                 1     2             0 #>  8    0   Exclude                                 0     2             0 #>  9    1   Include                                 1     2             0 #> 10    1   Include                                 1     2             0 #> 11    1   Include                                 1     2             0"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/AIscreenR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"AIscreenR: AI screening tools for systematic reviews — AIscreenR-package","title":"AIscreenR: AI screening tools for systematic reviews — AIscreenR-package","text":"Screening AI tools including ChatGPT.","code":""},{"path":[]},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/AIscreenR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"AIscreenR: AI screening tools for systematic reviews — AIscreenR-package","text":"Maintainer: Mikkel H. Vembye mikkel.vembye@gmail.com (ORCID)","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/approximate_price_gpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","title":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","text":"function supports approximation price total title abstract screening ChatGPT. function provide approximately accurate pricing estimates screenings drawing function calling function incl_function_simple (Default) since detailed descriptions increase completion tokens unknown amount furthermore rather model sensitive gpt-4 models yielding longer detailed responses relative gpt-3.5-turbo models.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/approximate_price_gpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","text":"","code":"approximate_price_gpt(   data,   prompt,   studyid,   title,   abstract,   model = \"gpt-3.5-turbo-0613\",   reps = 1,   top_p = 1,   token_word_ratio = 1.6 )"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/approximate_price_gpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","text":"data Dataset containing titles abstracts. prompt Prompt(s) paste title abstract. studyid Unique ID study. missing, generated automatically. title Name variable containing title information. abstract Name variable containing abstract information. model Character string name completion model. Can take multiple models, including gpt-4 models. Default = \"gpt-3.5-turbo-0613\". Find available model https://platform.openai.com/docs/models/model-endpoint-compatibility. reps Numerical value indicating number times question sent ChatGPT. can useful test consistency answers. Default 1 using 3.5 models, recommend setting value 10. top_p 'alternative sampling temperature, called nucleus sampling, model considers results tokens top_p probability mass. 0.1 means tokens comprising top 10% probability mass considered. generally recommend altering temperature .' (OPEN-AI). Default 1. Find documentation https://platform.openai.com/docs/api-reference/chat/create#chat/create-top_p. token_word_ratio multiplier used approximate number tokens per word. Default 1.6 empirically found average number tokens per word.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/approximate_price_gpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","text":"object class \"gpt_price\". object list containing following components: price numerical value indicating total approximate price (USD) screening across gpt-models expected used screening. price_data dataset prices across gpt models expected used screening.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/approximate_price_gpt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Approximate price estimation for title and abstract screening using ChatGPT models — approximate_price_gpt","text":"","code":"prompt <- \"This is a prompt\"  app_price <- approximate_price_gpt(   data = filges2015_dat[1:2,],   prompt = prompt,   studyid = studyid,   title = title,   abstract = abstract,   model = c(\"gpt-3.5-turbo-0613\", \"gpt-4\"),   reps = c(10, 1) )  app_price #> The approximate price of the (simple) screening will be around $0.0674. app_price$price_dollar #> [1] 0.0674 app_price$price_data #> # A tibble: 2 × 5 #>   model     iterations input_price_dollar output_price_dollar total_price_dollor #>   <chr>          <dbl>              <dbl>               <dbl>              <dbl> #> 1 gpt-3.5-…         10             0.0219             0.00044             0.0223 #> 2 gpt-4              1             0.0438             0.00132             0.0451"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/filges2015_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Ris-file data from Functional Family Therapy (FFT) systematic review — filges2015_dat","title":"Ris-file data from Functional Family Therapy (FFT) systematic review — filges2015_dat","text":"Bibliometric toy data systematic review regarding Functional Family Therapy (FFT) Young People Treatment Non-opioid Drug Use (Filges et al., 2015). data includes 100 excluded 50 included randomly sampled references literature search systematic review.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/filges2015_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ris-file data from Functional Family Therapy (FFT) systematic review — filges2015_dat","text":"","code":"filges2015_dat"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/filges2015_dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Ris-file data from Functional Family Therapy (FFT) systematic review — filges2015_dat","text":"tibble 150 rows/studies 6 variables/columns","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/filges2015_dat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ris-file data from Functional Family Therapy (FFT) systematic review — filges2015_dat","text":"Filges, T., Andersen, D, & Jørgensen, -M. K (2015). Functional Family Therapy (FFT) Young People Treatment Non-opioid Drug Use: Systematic Review Campbell Systematic Reviews, doi:10.4073/csr.2015.14","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":null,"dir":"Reference","previous_headings":"","what":"Get API key from R environment variable. — get_api_key","title":"Get API key from R environment variable. — get_api_key","text":"Get API key R environment variable.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get API key from R environment variable. — get_api_key","text":"","code":"get_api_key(env_var = \"CHATGPT_KEY\")"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get API key from R environment variable. — get_api_key","text":"env_var Character string indicating name temporary R environment variable API key used AI model. Currently, argument takes env_var = \"CHATGPT_KEY\". See set_api_key() set/create variable.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get API key from R environment variable. — get_api_key","text":"specified API key (NOTE: Avoid exposing console).","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get API key from R environment variable. — get_api_key","text":"get_api_key() can used executing set_api_key() adding api key permanently R environment using usethis::edit_r_environ(). write CHATGPT_KEY=[insert api key ] close .Renviron window restart R.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Get API key from R environment variable. — get_api_key","text":"Find personal API key https://platform.openai.com/account/api-keys.","code":""},{"path":[]},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/get_api_key.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get API key from R environment variable. — get_api_key","text":"","code":"if (FALSE) { get_api_key() }"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/is_chatgpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if the object is a chatgpt object — is_chatgpt","title":"Test if the object is a chatgpt object — is_chatgpt","text":"function returns TRUE chatgpt objects, FALSE objects.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/is_chatgpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if the object is a chatgpt object — is_chatgpt","text":"","code":"is_chatgpt(x)"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/is_chatgpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test if the object is a chatgpt object — is_chatgpt","text":"x object","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/is_chatgpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test if the object is a chatgpt object — is_chatgpt","text":"TRUE object inherits chatgpt class.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.chatgpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Print methods for 'chatgpt' objects — print.chatgpt","title":"Print methods for 'chatgpt' objects — print.chatgpt","text":"Print methods 'chatgpt' objects","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.chatgpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print methods for 'chatgpt' objects — print.chatgpt","text":"","code":"# S3 method for chatgpt print(x, ...)"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.chatgpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print methods for 'chatgpt' objects — print.chatgpt","text":"x object class 'chatgpt'. ... print arguments.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.chatgpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print methods for 'chatgpt' objects — print.chatgpt","text":"Information find answer data sets pricing information.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.chatgpt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print methods for 'chatgpt' objects — print.chatgpt","text":"","code":"if (FALSE) { print(x) }"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.gpt_price.html","id":null,"dir":"Reference","previous_headings":"","what":"Print methods for 'gpt_price' objects — print.gpt_price","title":"Print methods for 'gpt_price' objects — print.gpt_price","text":"Print methods 'gpt_price' objects","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.gpt_price.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print methods for 'gpt_price' objects — print.gpt_price","text":"","code":"# S3 method for gpt_price print(x, ...)"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.gpt_price.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print methods for 'gpt_price' objects — print.gpt_price","text":"x object class \"gpt_price\". ... print arguments.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.gpt_price.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print methods for 'gpt_price' objects — print.gpt_price","text":"total price screening across gpt-models expected used screening.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/print.gpt_price.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print methods for 'gpt_price' objects — print.gpt_price","text":"","code":"if (FALSE) { print(x) }"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/rate_limits_per_minute.html","id":null,"dir":"Reference","previous_headings":"","what":"Find updated rate limits for API models — rate_limits_per_minute","title":"Find updated rate limits for API models — rate_limits_per_minute","text":"rate_limits_per_minute reports rate limits given api. function returns available requests per minute (RPM) well tokens per minute (TPM). Find general information https://platform.openai.com/docs/guides/rate-limits/overview.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/rate_limits_per_minute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find updated rate limits for API models — rate_limits_per_minute","text":"","code":"rate_limits_per_minute(   model = \"gpt-3.5-turbo-0613\",   AI_tool = \"chatgpt\",   api_key = get_api_key() )"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/rate_limits_per_minute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find updated rate limits for API models — rate_limits_per_minute","text":"model Character string name completion model. Default = \"gpt-3.5-turbo-0613\". Can take multiple strings. Find available model https://platform.openai.com/docs/models/model-endpoint-compatibility. AI_tool Character string specifying AI tool api issued. Default \"chatgpt\". api_key Numerical value personal API key. Find https://platform.openai.com/account/api-keys. Use secret_make_key(), secret_encrypt(), secret_decrypt() scramble decrypt api key use set_api_key() securely automate use api key setting api key locale environment variable.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/rate_limits_per_minute.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find updated rate limits for API models — rate_limits_per_minute","text":"tibble including variables information model used, number requests tokens per minute.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/rate_limits_per_minute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find updated rate limits for API models — rate_limits_per_minute","text":"","code":"if (FALSE) { set_api_key()  rate_limits_per_minute() }"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":null,"dir":"Reference","previous_headings":"","what":"Creating a temporary R environment API key variable — set_api_key","title":"Creating a temporary R environment API key variable — set_api_key","text":"function automatically sets/creates interim R environment variable API key call given AI model (e.g. ChatGPT). Thereby users avoid exposing API keys. API key set console, /can revealed via .Rhistory. Find information issue https://httr2.r-lib.org/articles/wrapping-apis.html.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creating a temporary R environment API key variable — set_api_key","text":"","code":"set_api_key(key, env_var = \"CHATGPT_KEY\")"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creating a temporary R environment API key variable — set_api_key","text":"key Character string (ideally encrypt) API key. See encrypt key : https://httr2.r-lib.org/articles/wrapping-apis.html#basics. provided, returns password box true API key can secretly entered. env_var Character string indicating name temporary R environment variable API key used AI model. Currently, argument takes env_var = \"CHATGPT_KEY\".","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creating a temporary R environment API key variable — set_api_key","text":"temporary environment variable name env_var. key missing, returns password box true API key can entered.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Creating a temporary R environment API key variable — set_api_key","text":"set_api_key() successfully executed, get_api_key() automatically retrieves API key R environment users need specify API running functions package call API. API key can permanently set using usethis::edit_r_environ(). write CHATGPT_KEY=[insert api key ] close .Renviron window restart R.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Creating a temporary R environment API key variable — set_api_key","text":"Find personal API key https://platform.openai.com/account/api-keys.","code":""},{"path":[]},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/set_api_key.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creating a temporary R environment API key variable — set_api_key","text":"","code":"if (FALSE) { set_api_key() }"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"function supports conduct title abstract screening ChatGPT R. function allows run title abstract screening across multiple prompts repeated questions check consistency across answers. function draws newly developed function calling better steer output responses.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"","code":"tabscreen_gpt(   data,   prompt,   studyid,   title,   abstract,   ...,   arrange_var = studyid,   model = \"gpt-3.5-turbo-0613\",   role = \"user\",   functions = incl_function_simple,   function_call_name = list(name = \"inclusion_decision_simple\"),   top_p = 1,   time_info = TRUE,   token_info = TRUE,   api_key = get_api_key(),   max_tries = 8,   max_seconds = NULL,   is_transient = gpt_is_transient,   backoff = NULL,   after = NULL,   rpm = 10000,   reps = 1,   seed = NULL,   progress = TRUE,   messages = TRUE,   incl_cutoff_upper = 0.5,   incl_cutoff_lower = 0.4 )"},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"data Dataset containing titles abstracts. prompt Prompt(s) paste title abstract. studyid Unique ID study. missing, generated automatically. title Name variable containing title information. abstract Name variable containing abstract information. ... argument pass request body. See https://platform.openai.com/docs/api-reference/chat/create. arrange_var Function indicating variables determining arrangement data. Default studyid. model Character string name completion model. Can take multiple models, including gpt-4 models. Default = \"gpt-3.5-turbo-0613\". Find available model https://platform.openai.com/docs/models/model-endpoint-compatibility. role Character string indicate role user. Default \"user\". functions Function steer output. Default incl_function_simple. get detailed responses use AIscreenR:::incl_function. Also see 'Examples . Find documentation function calling https://openai.com/blog/function-calling---api-updates. function_call_name Functions call. Default list(name = \"inclusion_decision_simple\"). get detailed responses use list(name = \"inclusion_decision\"). Also see 'Examples . top_p 'alternative sampling temperature, called nucleus sampling, model considers results tokens top_p probability mass. 0.1 means tokens comprising top 10% probability mass considered. generally recommend altering temperature .' (OPEN-AI). Default 1. Find documentation https://platform.openai.com/docs/api-reference/chat/create#chat/create-top_p. time_info Logical indicating whether run time request/question included data. Default = TRUE. token_info Logical indicating whether number prompt completion tokens per request included output data. Default = TRUE. TRUE, output object include price information conducted screening. api_key Numerical value personal API key. Find https://platform.openai.com/account/api-keys. Use secret_make_key(), secret_encrypt(), secret_decrypt() scramble decrypt api key use set_api_key() securely automate use api key setting api key locale environment variable. max_tries, max_seconds 'Cap maximum number attempts max_tries total elapsed time first request max_seconds. neither option supplied (default), req_perform() retry' (Wickham, 2023). is_transient 'predicate function takes single argument (response) returns TRUE FALSE specifying whether response represents transient error' (Wickham, 2023). backoff 'function takes single argument (number failed attempts far) returns number seconds wait' (Wickham, 2023). 'function takes single argument (response) returns either number seconds wait NULL, indicates precise wait time available backoff strategy used instead' (Wickham, 2023). rpm Numerical value indicating number requests per minute (rpm) available specified api key. Find information https://platform.openai.com/docs/guides/rate-limits/---rate-limits---api. Alternatively, use rate_limits_per_minute(). reps Numerical value indicating number times question sent ChatGPT. can useful test consistency answers. Default 1 using 3.5 models, recommend setting value 10. seed Numerical value seed ensure proper, parallel-safe random numbers produced. progress Logical indicating whether progress line shown running title abstract screening parallel. Default TRUE. messages Logical indicating whether print messages embedded function. Defualt TRUE. incl_cutoff_upper Numerical value indicating probability threshold studies included. Default 0.5, indicates titles abstracts ChatGPT included 50 percent times included. incl_cutoff_lower Numerical value indicating probability threshold studies check human. Default 0.4, means ask ChatGPT questions 10 times includes title abstract 4 times, suggest study check human.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"object class \"chatgpt\". object list containing following components: answer_data_sum dataset summerized, probalistic inclusion decision title abstract across multiple repeated questions. answer_data_all dataset individual answers. price numerical value indicating total price (USD) screening. price_data dataset prices across gpt models used screening.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"answer_data_sum data contains following mandatory variables: answer_data_all data contains following mandatory variables: requests failed reach server, chatgpt object contains error data set (error_data) variables answer_data_all failed request references . price_data data contains following variables: Find current token pricing https://openai.com/pricing.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"Wickham H (2023). httr2: Perform HTTP Requests Process Responses. https://httr2.r-lib.org, https://github.com/r-lib/httr2.","code":""},{"path":"https://mikkelvembye.github.io/AIscreenR/reference/tabscreen_gpt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Title and abstract screening with ChatGPT using function calls. — tabscreen_gpt","text":"","code":"if (FALSE) {  prompt <- \"Is this study about a Functional Family Therapy (FFT) intervention?\"  tabscreen_gpt(   data = filges2015_dat[1:2,],   prompt = prompt,   studyid = studyid,   title = title,   abstract = abstract,   model = c(\"gpt-3.5-turbo-0613\", \"gpt-3.5-turbo-16k-0613\"),   max_tries = 1,   reps = 10   )   # Get detailed descriptions of the gpt decisions by using the  # embedded function calling functions from the package. See example below.  tabscreen_gpt(    data = filges2015_dat[1:2,],    prompt = prompt,    studyid = studyid,    title = title,    abstract = abstract,    functions = AIscreenR:::incl_function,    function_call_name = list(name = \"inclusion_decision\"),    max_tries = 1,    reps = 2  ) }"}]
