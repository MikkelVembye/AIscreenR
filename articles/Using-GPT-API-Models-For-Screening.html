<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews • AIscreenR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AIscreenR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Using-GPT-API-Models-For-Screening.html">Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MikkelVembye/AIscreenR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews</h1>
            
            <h4 data-toc-skip class="date">2024-11-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MikkelVembye/AIscreenR/blob/main/vignettes/Using-GPT-API-Models-For-Screening.Rmd" class="external-link"><code>vignettes/Using-GPT-API-Models-For-Screening.Rmd</code></a></small>
      <div class="d-none name"><code>Using-GPT-API-Models-For-Screening.Rmd</code></div>
    </div>

    
    
<div class="warning" style="margin-left:2em; margin-right:2em; margin-bottom:2em; margin-top:2em; padding:0.1em; background-color: #d7dbdd; border: solid #bdc3c7 3px">
<span>
<p style="margin-top:1em; text-align:center">
<b>Important note</b>
</p>
<p style="margin:1em">
<em>This is work-in-progress only. For now, see <a href="https://osf.io/preprints/osf/yrhzm" class="external-link">Vembye, Christensen, Mølgaard,
&amp; Schytt</a> <span class="citation">(<a href="#ref-Vembye2024_gpt">2024</a>)</span> for an overview of how and
when GPT API models can be used for title and abstract (TAB) screening.
Our most recent results suggest that the <code>gpt-4o-mini</code> is an
effective model for screening titles and abstracts with performances in
many cases on par with <code>gpt-4</code>. This is a very cheap model
(200 times cheaper than <code>gpt-4</code>). Therefore, to reduce costs,
we recommendation always testing the performance of
<code>gpt-4o-mini</code> before considering other models. For an
overview of additional research on the use of GPT API models for title
and abstract screening, see Syriani et al. <span class="citation">(<a href="#ref-Syriani2023">2023</a>, <a href="#ref-Syriani2024">2024</a>)</span>, Guo et al., <span class="citation">(<a href="#ref-Guo2024">2024</a>)</span>, and Gargari
et al. <span class="citation">(<a href="#ref-Gargari2024">2024</a>)</span>. In a related line of research,
Alshami et al. <span class="citation">(<a href="#ref-Alshami2023">2023</a>)</span>, Khraisha et al. <span class="citation">(<a href="#ref-Khraisha2024">2024</a>)</span>, and
Issaiy et al. <span class="citation">(<a href="#ref-Issaiy2024">Issaiy
et al., 2024</a>)</span> explored the use of the ChatGPT web browser
interface for TAB screening. Based on our experience, we believe these
two lines of research should not be conflated, as they rely on different
GPT models and setups.</em>
</p>
<p></p></span>
</div>
<p>Conducting a systematic review is most often resource-demanding. A
critical first step to ensure the quality of systematic reviews and
meta-analyses herein involves detecting all eligible references related
to the literature under review <span class="citation">(<a href="#ref-Polanin2019">Polanin, Pigott, Espelage, &amp; Grotpeter,
2019</a>)</span>. This entails searching all pertinent literature
databases relevant to the given review, most often resulting in
thousands of titles and abstracts to be screened for relevance. Manual
screening hereof can be a time-consuming and tedious task. However,
overlooking relevant studies at this stage can be consequential, leading
to substantially biased results if the missed studies differ
systematically from the detected studies. To mitigate this resource
issue, we demonstrate in this vignette how to use OpenAI’s GPT
(Generative Pre-trained Transformer) API (Application Programming
Interface) models for title and abstract screening in R. Specifically,
we show how to create a test dataset and assess whether GPT is viable as
the second screener in your review <span class="citation">(cf. <a href="#ref-Vembye2024_gpt">Vembye et al., 2024</a>)</span>.  </p>
<p>At this point, you might ask, why use GPT API models via R instead of
simply using ChatGPT for screening? The answer is that using R offer
certain advantages:</p>
<ol style="list-style-type: decimal">
<li>Reviewers can easily work with a large number of references,
avoiding the need for manual copy-paste procedures <span class="citation">(cf. <a href="#ref-Khraisha2024">Khraisha et al.,
2024</a>)</span>.<br>
</li>
<li>The screening time can be substantially reduced compared to using
the ChatGPT interface, as screening can be performed in parallel. In
theory, you can screen 30,000 titles and abstracts per minute.</li>
<li>It eases model comparison.</li>
<li>Consistency between the GPT answer for the same title and abstract
can be easily tested. You can also conduct multiple screenings and make
inclusion judgments based on how often a study is included across a set
number of screenings.</li>
<li>When using the <code>gpt-4o-mini</code>, it is often cheaper than
subscribing to ChatGPT plus.</li>
<li>Research suggest that GPT API models and the ChatGPT yield notably
different screening performance, with the latter proving insufficient as
an independent second screener.</li>
</ol>
<p>That said, we would also like to emphasize that screening with the
GPT API models should be conducted carefully and always be assisted by
humans (human-in-the-loop). Consequently, we do not recommend to use the
a GPT API model as a single screener, unless this an absolutely final
solution. When using a GPT API model as the second screener, we also
recommend completing the human screening before uploading RIS-file(s) to
R. This allows for immediate comparison once the GPT screening is
complete and ensures humans are then not impacted/biased by the GPT
decision.</p>
<div class="section level2">
<h2 id="get-started">Get started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<p>For many reviewers, especially those unfamiliar with coding in R,
conducting a title and abstract screening in R can seem overwhelming.
However, it’s important to emphasize that running your first screening
only requires a few relatively simple steps:</p>
<ol style="list-style-type: decimal">
<li>Load and convert your RIS-file data to a data frame.</li>
<li>Handle your API key (this is only necessary the first time you
screen).</li>
<li>Make one or multiple prompts.</li>
<li>Run the screening.</li>
</ol>
<p>And if the human screening has been conducted (as in the example
below):</p>
<ol start="5" style="list-style-type: decimal">
<li>Analyze the screening results.</li>
<li>Investigate and resolve any disagreements.</li>
</ol>
<p>We will walk through each of these steps one by one in the following
sections.</p>
</div>
<div class="section level2">
<h2 id="load-and-convert-to-ris-file-data-to-a-data-frame">Load and convert to RIS file data to a data frame<a class="anchor" aria-label="anchor" href="#load-and-convert-to-ris-file-data-to-a-data-frame"></a>
</h2>
<p>At this stage, we expect that you have a colelction of RIS files
containing titles and abstracts for the references you wish to screen.
You can obtain RIS files in several ways: directly from the research
databases, a Google Scholar search; or by exported them from your
reference management tool, such as EndNote, Mendeley, and RefMan.
Alternatively, you can export RIS files from systematic software tools
such as <a href="https://eppi.ioe.ac.uk/cms/Default.aspx?tabid=2914" class="external-link">EPPI-reviewer</a>,
<a href="https://www.covidence.org/" class="external-link">Covidence</a>, <a href="https://www.metareviewer.org/" class="external-link">MetaReviewer</a>, <a href="http://www.eshackathon.org/revtools/" class="external-link"><code>revtools</code></a>
<span class="citation">(<a href="#ref-westgate2019">Westgate,
2019</a>)</span>, among others. In the example below, we load RIS files
extracted from <a href="https://eppi.ioe.ac.uk/cms/Default.aspx?tabid=2914" class="external-link">EPPI-reviewer</a>.
A minor advantage of exporting RIS files from systematic software tools
is that they often add a unique study ID to each reference, making it
easier to track the screening process. However, such IDs are
automatically generated in <code><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt()</a></code> if they are
missing.</p>
<div class="section level3">
<h3 id="load-relevant-r-packages">Load relevant R packages<a class="anchor" aria-label="anchor" href="#load-relevant-r-packages"></a>
</h3>
<p>To get started, we first load all R package needed to construct and
run the screening.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading packages </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikkelvembye.github.io/AIscreenR/">AIscreenR</a></span><span class="op">)</span> <span class="co"># Used to screen and calculate gpt vs. human performance</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://revtools.net" class="external-link">revtools</a></span><span class="op">)</span>  <span class="co"># Used to load RIS-files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>    <span class="co"># Used to work with tibbles</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>     <span class="co"># Used to manipulate data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span>     <span class="co"># For loops </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org" class="external-link">usethis</a></span><span class="op">)</span>   <span class="co"># Used to add the API key the R environment (only relevant the first time you screen)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span>    <span class="co"># Used to conduct screenings in parallel</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convert-ris-files-to-data-frames">Convert RIS-files to data frames<a class="anchor" aria-label="anchor" href="#convert-ris-files-to-data-frames"></a>
</h3>
<p>Now, we are ready to conduct the first step of the screening, which
is to load our RIS-file data into R and convert it to a data frame. This
can be done by using <code>read_bibliography()</code> from
<code>revtools</code>. In the below example, we use RIS-file data from a
review regarding the effects of the FRIENDS preventive programme on
anxiety symptoms in children and adolescents <span class="citation">(<a href="#ref-Filges2024">Filges, Smedslund, Eriksen, Birkefoss, &amp;
Kildemoes, 2024</a>)</span>. Be aware, that this data is used for
illustration purposes only. Thus, no hard inferences should be drawn
from this example. In the example, we assume that the humans have
started screening and found a bunch of relevant and irrelevant studies
from which they can create the test data. Thus, we can load the
RIS-files, which we downloaded from the EPPI-reviewer separately for the
in- and excluded RIS-files. This enables us to track the human decision
by adding a <code>human_code</code> variable, where <code>1</code> and
<code>0</code> indicates whether a study should be in- or excluded.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NOTE: Find the RIS-files behind this vignette at https://osf.io/kfbvu/</span></span>
<span></span>
<span><span class="co"># Loading EXCLUDED studies</span></span>
<span><span class="va">ris_dat_excl</span> <span class="op">&lt;-</span> <span class="fu">revtools</span><span class="fu">::</span><span class="fu">read_bibliography</span><span class="op">(</span><span class="st">"friends_excl.ris"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add the path to your RIS-file here</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">eppi_id</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Using only relevant variables</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    human_code <span class="op">=</span> <span class="fl">0</span>, <span class="co">#Tracking the human decision</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2,765 × 5</span></span>
<span><span class="co">#&gt;   author                                                                eppi_id title abstract human_code</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                                 &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Lovat C                                                               911525… "'Ba… "Postna…          0</span></span>
<span><span class="co">#&gt; 2 Kohler Maxie                                                          911023… "\"F… "The ar…          0</span></span>
<span><span class="co">#&gt; 3 Stevens Eleanor and Wood Jane                                         911020… "\"I… "'Non-o…          0</span></span>
<span><span class="co">#&gt; 4 Essau C and Conradt J and Ederer E                                    915786… "[An…  NA               0</span></span>
<span><span class="co">#&gt; 5 K&lt;c3&gt;&lt;a4&gt;ssler P and Breme K                                          915784… "[Ev…  NA               0</span></span>
<span><span class="co">#&gt; 6 Brubaker Ruth B and Bay Curt and Chacon Daniel W and Carson Madelein… 911523… "93 … "Introd…          0</span></span>
<span><span class="co">#&gt; 7 Kumar Suresh and Vellymalay N                                         915785… "A C…  NA               0</span></span>
<span><span class="co">#&gt; 8 Lock S                                                                915784… "A D…  NA               0</span></span>
<span><span class="co">#&gt; 9 Bosco Nicolina and Giaccherini Susanna and Meringolo Patrizia         911019… "A g… "This a…          0</span></span>
<span><span class="co">#&gt;10 Abd El Salam, Amira E and AbdAllah Amany M and El Maghawry Hala A     911017… "Eff… "Backgr…          0</span></span>
<span><span class="co">#&gt;# ℹ 2,755 more rows</span></span>
<span><span class="co">#&gt;# ℹ Use `print(n = ...)` to see more rows</span></span>
<span></span>
<span><span class="co"># Loading INCLUDED studies</span></span>
<span><span class="va">ris_dat_incl</span> <span class="op">&lt;-</span> <span class="fu">revtools</span><span class="fu">::</span><span class="fu">read_bibliography</span><span class="op">(</span><span class="st">"friends_incl.ris"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">eppi_id</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    human_code <span class="op">=</span> <span class="fl">1</span>, <span class="co">#Tracking the human decision</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 97 × 5</span></span>
<span><span class="co">#&gt;   author                                                                eppi_id title abstract human_code</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                                 &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 G&lt;c3&gt;&lt;b6&gt;kkaya Fu&lt;cc&gt;&lt;88&gt;sun and Gedik Z                              915785… A Sc…  NA               1</span></span>
<span><span class="co">#&gt; 2 ACTRN12607000254493                                                   911528… Long… "INTERV…          1</span></span>
<span><span class="co">#&gt; 3 ACTRN12615000382572                                                   911528… The … "INTERV…          1</span></span>
<span><span class="co">#&gt; 4 Ahlen Johan and Breitholtz Elisabeth and Barrett Paula M and Gallego… 911544… Scho… "Anxiet…          1</span></span>
<span><span class="co">#&gt; 5 Ahlen Johan and Hursti Timo and Tanner Lindsey and Tokay Zelal and G… 911019… Prev… "Our st…          1</span></span>
<span><span class="co">#&gt; 6 Green Sarah L                                                         915785… An e…  NA               1</span></span>
<span><span class="co">#&gt; 7 Anticich Sarah A. J and Barrett Paula M and Silverman Wendy and Lach… 910111… The … "This s…          1</span></span>
<span><span class="co">#&gt; 8 Barker Leslie Jayne                                                   915785… Prev…  NA               1</span></span>
<span><span class="co">#&gt; 9 Barrett PM and Moore AF and Sonderegger R                             911527… The … "Young …          1</span></span>
<span><span class="co">#&gt;10 Barrett PM and Shortt AL and Wescombe K                               911529… Exam…  NA               1</span></span>
<span><span class="co">#&gt;# ℹ 87 more rows</span></span>
<span><span class="co">#&gt;# ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-the-test-dataset">Create the test dataset<a class="anchor" aria-label="anchor" href="#create-the-test-dataset"></a>
</h3>
<p>As you see, we have now loaded our reference data and can construct
the test data by random sample 150 irrelevant <span class="citation">(as
suggested in <a href="#ref-Vembye2024_gpt">Vembye et al.,
2024</a>)</span> and 50 relevant records with an title and abstract. For
this purpose we use <code><a href="../reference/sample_references.html">sample_references()</a></code>. Again, this is for
illustration purposes only, since you might not necessarily have access
to 50 relevant records at this stage of the screening. We recommend
finding at least 10 relevant reference before constructing the test
data. As further described in Vembye et al. <span class="citation">(<a href="#ref-Vembye2024_gpt">2024</a>)</span>, we remove all records with
no abstract since these can distort the accuracy of the screening.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">09042024</span><span class="op">)</span></span>
<span></span>
<span><span class="va">excl_sample</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">ris_dat_excl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstract</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sample_references.html">sample_references</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="va">incl_sample</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">ris_dat_incl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstract</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sample_references.html">sample_references</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_dat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">excl_sample</span>, <span class="va">incl_sample</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    studyid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">studyid</span>, .after <span class="op">=</span> <span class="va">eppi_id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">test_dat</span></span>
<span><span class="co">#&gt;  # A tibble: 200 × 6</span></span>
<span><span class="co">#&gt;   author             eppi_id studyid title abstract human_code</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;chr&gt;     &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Moes and Frea Dou… 9433823       1 Usin… Studies…          0</span></span>
<span><span class="co">#&gt; 2 Flemke Kimberly R  9432288       2 The … The pur…          0</span></span>
<span><span class="co">#&gt; 3 Daniels M Harry a… 9431426       3 A Me… One of …          0</span></span>
<span><span class="co">#&gt; 4 Schwartzman Mered… 9434093       4 Enha… New ana…          0</span></span>
<span><span class="co">#&gt; 5 White Stuart F an… 9434418       5 Call… OBJECTI…          0</span></span>
<span><span class="co">#&gt; 6 Chao-kai X U and … 9432240       6 A no… To deal…          0</span></span>
<span><span class="co">#&gt; 7 Todd Thomas C      9434199       7 THE … This ar…          0</span></span>
<span><span class="co">#&gt; 8 Kinoshita O and K… 9431762       8 Spec… BACKGRO…          0</span></span>
<span><span class="co">#&gt; 9 Stratton Peter an… 9434563       9 Comp… This ar…          0</span></span>
<span><span class="co">#&gt;10 Stevens Sally and… 9434158      10 Inte… The num…          0</span></span>
<span><span class="co">#&gt;# ℹ 190 more rows</span></span>
<span><span class="co">#&gt;# ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="handle-your-api-key">Handle your API key<a class="anchor" aria-label="anchor" href="#handle-your-api-key"></a>
</h2>
<p>We now have our test data in place and can move on to the next step
of the screening, which involves generating your API key and handle it
in R.</p>
<div class="section level3">
<h3 id="get-your-api-key">Get your API key<a class="anchor" aria-label="anchor" href="#get-your-api-key"></a>
</h3>
<p>Before you can use the <code>AIscreenR</code> functions to screen
your references, you must generate your own secret API key from OpenAI.
To do so you must first ensure that you have created an account at
OpenAI (<em>if you have not done so at this stage, you can sign up <a href="https://auth0.openai.com/u/login/identifier?state=hKFo2SBqQjNHSlc1ejIyREpUb01hdDF2OHEzQy12NnJwWlFUN6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIEJSOWJaamdKLWswNGlfWDQ2NER1OXJmVUNpVmVzVjZfo2NpZNkgRFJpdnNubTJNdTQyVDNLT3BxZHR3QjNOWXZpSFl6d0Q" class="external-link">here</a>).</em>
When having an account, go to <a href="https://platform.openai.com/account/api-keys" class="external-link">https://platform.openai.com/account/api-keys</a>
and press the <code>+ Create new secret key</code> button (see Figure 1
below) and give your key a name.</p>
<p> </p>
<div class="figure">
<img src="helper-stuff%2FAPI_key_pic.png" alt="*Figure 1 - Generate API key from OpenAI*" width="100%"><p class="caption">
<em>Figure 1 - Generate API key from OpenAI</em>
</p>
</div>
<p> </p>
<p>When you have generated your secret API key, remember to store it
safely since you will not be able see it again. <strong>NOTE</strong>:
<em>If you lose your API key, you can just generate a new one</em>.</p>
</div>
<div class="section level3">
<h3 id="manage-your-api-key-in-r">Manage your API key in R<a class="anchor" aria-label="anchor" href="#manage-your-api-key-in-r"></a>
</h3>
<p>When you have retrieved your API, you could in theory add it directly
to the <code>AIscreenR</code> functions via the <code>api_key</code>
argument. Yet, this would be an improper way to work the API key since
you would easily compromise your secret key. For example, your API key
would be disclosed when sharing your codes with others, which gives them
access to draw on your OpenAI account. Furthermore, OpenAI will cancel
the API key if they recognize that your API key has been compromised
(e.g., if you push it to a public GitHub page). To overcome this issue
you have several options from here. You can either work with what we
call a permanent or temporary solution.</p>
<div class="section level4">
<h4 id="permanent-solution">Permanent solution<a class="anchor" aria-label="anchor" href="#permanent-solution"></a>
</h4>
<p>The easiest way to work with your API key is to permanently add it to
your R environment as an environment variable. This can be achieved with
<code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run code to open your .Renviron file</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In the <code>.Renviron</code> file, write
<code>CHATGPT_KEY=your_key</code> as depicted in Figure 2.  </p>
<div class="figure">
<img src="helper-stuff%2FRenviron.png" alt="*Figure 2 - R environment file*" width="100%"><p class="caption">
<em>Figure 2 - R environment file</em>
</p>
</div>
<p> </p>
<p>Thereafter, close and save the <code>.Renviron</code> file and
restart <code>RStudio</code> (ctrl + shift + F10). From now on, the
<code>AIscreenR</code> functions will use <code><a href="../reference/get_api_key.html">get_api_key()</a></code> to
retrieve your API key from your R environment automatically. By using
this approach you do not have to worry more about you API key (unless
you update RStudio, deliberately delete the key, or get a new computer.
Then you must repeat this process).</p>
</div>
<div class="section level4">
<h4 id="temporary-solution">Temporary solution<a class="anchor" aria-label="anchor" href="#temporary-solution"></a>
</h4>
<p>If you do not want to add you API key permanently to your R
environment, you can use <code><a href="../reference/set_api_key.html">set_api_key()</a></code>. When executing
<code><a href="../reference/set_api_key.html">set_api_key()</a></code>, you will see a pop-up window in which you
can enter your API key. This will add your API key as temporary
environment variable. Consequently, when you restart RStudio, you will
no longer be able to find your API key in your R environment.
Alternatively, you can pass a decrypted key to the
<code><a href="../reference/set_api_key.html">set_api_key()</a></code>, like
<code>set_api_key(key = secret_decrypt(encrypt_key, "YOUR_SECRET_KEY_FOR_DECRYTING"))</code>.
See the <a href="https://httr2.r-lib.org/articles/wrapping-apis.html#basics" class="external-link"><code>HTTR2</code></a>
package for further details about this solution.  </p>
<div class="figure">
<img src="helper-stuff%2Fset_api.png" alt="*Figure 3 - Set API key*" width="100%"><p class="caption">
<em>Figure 3 - Set API key</em>
</p>
</div>
<p> </p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="prompting-in-r">Prompting in R<a class="anchor" aria-label="anchor" href="#prompting-in-r"></a>
</h2>
<p>The next step involves writing one or multiple prompts that can be
used for the screening. This can be done in several ways. You can either
write your prompt directly in R, as illustrated below</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prompt</span> <span class="op">&lt;-</span> <span class="st">"We are screening studies for a systematic literature review. </span></span>
<span><span class="st">The topic of the systematic review is the effect of the FRIENDS preventive programme on reducing</span></span>
<span><span class="st">anxiety symptoms in children and adolescents. The FRIENDS programme is a 10-session manualised </span></span>
<span><span class="st">cognitive behavioural therapy (CBT) programme which can be used as both prevention and </span></span>
<span><span class="st">treatment of child and youth anxiety.  The study should focus exclusively on this topic </span></span>
<span><span class="st">and we are exclusively searching  for studies with a treatment and a comparison group. </span></span>
<span><span class="st">For each study, I would like you to assess:  1) Is the study about the FRIENDS preventive programme?  </span></span>
<span><span class="st">2) Is the study estimating an effect between a treatment and control/comparison group?"</span></span></code></pre></div>
<p>Or you can just write it in Word as shown in Figures 4.</p>
<p> </p>
<div class="figure">
<img src="helper-stuff%2Ffriends_prompt.png" alt="*Figure 4 - Prompting in Word*" width="100%"><p class="caption">
<em>Figure 4 - Prompting in Word</em>
</p>
</div>
<p> </p>
<p>Then you can load your prompt(s) via <code>readtext()</code> from the
<code>readtext</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">word_path</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"word_prompt_1.docx"</span>, package <span class="op">=</span> <span class="st">"AIscreenR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prompt</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">readtext</span><span class="fu">::</span><span class="fu">readtext</span><span class="op">(</span><span class="va">word_path</span><span class="op">)</span><span class="op">$</span><span class="va">text</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove_all</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-the-screening">Run the screening<a class="anchor" aria-label="anchor" href="#run-the-screening"></a>
</h2>
<p>Now you are actually ready to conduct the title and abstract
screening with <code><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt()</a></code>. To make the
<code><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt()</a></code> running, you need to specify the following
information:</p>
<ol style="list-style-type: decimal">
<li>The data with the title and abstract information.</li>
<li>The prompt(s).</li>
<li>The variable names of variables containing the titles and
abstracts.</li>
<li>The model(s) you want to use for screening.</li>
</ol>
<p>Optional</p>
<ol start="5" style="list-style-type: decimal">
<li>The variable name of the variable containing the study IDs.</li>
<li>The number of screenings you want to run with the given model
(Default is <code>1</code> but with cheap models it can be advantageous
to conduct multiple screenings and make inclusion judgments based on how
many times a study has been included across the set of screenings).</li>
<li>Set the request per minutes.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get information about whether you have access to a given model and </span></span>
<span><span class="co"># how many requests per minutes you are allow to send. </span></span>
<span><span class="va">models_rpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rate_limits_per_minute.html">rate_limits_per_minute</a></span><span class="op">(</span><span class="st">"gpt-4o-mini"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set parallel plan</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">result_object</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test_dat</span>, <span class="co"># RIS-file data created above </span></span>
<span>    prompt <span class="op">=</span> <span class="va">prompt</span>, <span class="co"># The prompt made above</span></span>
<span>    studyid <span class="op">=</span> <span class="va">studyid</span>, <span class="co"># Name of variable containing study IDs</span></span>
<span>    title <span class="op">=</span> <span class="va">title</span>, <span class="co"># Name of variable containing titles</span></span>
<span>    abstract <span class="op">=</span> <span class="va">abstract</span>, <span class="co"># Name of variable containing abstracts</span></span>
<span>    model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>, <span class="co"># Model choice</span></span>
<span>    reps <span class="op">=</span> <span class="fl">10</span>, <span class="co"># Using multiple screenings with the cheap gpt-4o-mini model</span></span>
<span>    rpm <span class="op">=</span> <span class="va">models_rpm</span><span class="op">$</span><span class="va">requests_per_minute</span> <span class="co"># Requests per minutes retrieved from the above object</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; * The approximate price of the current (simple) screening will be around $0.2237.</span></span>
<span><span class="co">#&gt; Progress: ───────────────────────────────────────────────────────────────── 100%</span></span>
<span></span>
<span><span class="co"># Back to the sequential plan</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
<p>We have now conducted the test screening and can get the raw results
as below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The print output when calling the result object</span></span>
<span><span class="va">result_object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the final result dataset via result_object$answer_data_aggregated</span></span>
<span></span>
<span><span class="va">result_object</span><span class="op">$</span><span class="va">answer_data_aggregated</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">human_code</span>, <span class="va">final_decision_gpt</span>, <span class="va">final_decision_gpt_num</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 200 × 4</span></span>
<span><span class="co">#&gt;   author                                       human_code final_decision_gpt final_decision_gpt_num</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                             &lt;dbl&gt; &lt;chr&gt;                               &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Lara Elvira and Mart&lt;c3&gt;&lt;ad&gt;n-Mar&lt;c3&gt;&lt;ad&gt;a …          0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 2 Matsumoto Manabu                                      0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 3 Jordan Ann                                            0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 4 Antonova E and Hamid A and Wright B and Kum…          0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 5 Iafusco Dario                                         0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 6 Farrell L J and Barrett P M and Claassens S           0 Include                                 1</span></span>
<span><span class="co">#&gt; 7 Rasalingam G and Rajalingam A and Chandrada…          0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 8 Chappel J N and DuPont R L                            0 Exclude                                 0</span></span>
<span><span class="co">#&gt; 9 Waldrop Deborah P                                     0 Exclude                                 0</span></span>
<span><span class="co">#&gt;10 Ioana-Eva C&lt;c4&gt;&lt;83&gt;dariu and Rad Dana                 0 Exclude                                 0</span></span>
<span><span class="co">#&gt;# ℹ 190 more rows</span></span>
<span><span class="co">#&gt;# ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<div class="section level3">
<h3 id="screen-failed-requests">Screen failed requests<a class="anchor" aria-label="anchor" href="#screen-failed-requests"></a>
</h3>
<p>If might happen that you experience that some of your screenings
requests failed for some transient reason, for example because the
server was overloaded or something else. To recover these failed request
you can use <code>screen_error()</code>, as done below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_object</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/screen_errors.html">screen_errors</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analyze-screening">Analyze screening<a class="anchor" aria-label="anchor" href="#analyze-screening"></a>
</h2>
<p>We have now conducted the test screening and want to assess whehter
it is viable to use the <code>gpt-4o-mini</code> model as our second
screener. For the purpose, we can use the
<code><a href="../reference/screen_analyzer.html">screen_analyzer()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">screen_performance</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/screen_analyzer.html">screen_analyzer</a></span><span class="op">(</span>human_decision <span class="op">=</span> <span class="va">human_code</span><span class="op">)</span> <span class="co"># state the name of the variable containing the human decision. </span></span>
<span></span>
<span><span class="va">screen_performance</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 9</span></span>
<span><span class="co">#&gt;   promptid model        reps top_p p_agreement recall specificity incl_p criteria                             </span></span>
<span><span class="co">#&gt;      &lt;int&gt; &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                      </span></span>
<span><span class="co">#&gt;1        1 gpt-4o-mini    10     1        0.97   0.92       0.987    0.4 Studies have been included in at least 40% of the 10 screenings.</span></span></code></pre></div>
<div class="section level3">
<h3 id="assess-results-via-a-benchmark-scheme">Assess results via a benchmark scheme<a class="anchor" aria-label="anchor" href="#assess-results-via-a-benchmark-scheme"></a>
</h3>
<p>But you might ask, how do we assess whether the performances for of
the model is acceptable as a second screener? To answer this question,
we have suggested to assess this via benchmarking. In Vembye et al.
<span class="citation">(<a href="#ref-Vembye2024_gpt">2024</a>)</span>,
we developed a benchmark scheme based on typical duplicate human
screening performance from 22 high-quality reviews. This scheme can be
found in Figure 5.</p>
<div class="figure">
<img src="helper-stuff%2Fbenchmark_scheme.png" alt="*Figure 5 - Generic benchmark scheme from Vembye et al. (2024)*" width="100%"><p class="caption">
<em>Figure 5 - Generic benchmark scheme from Vembye et al. (2024)</em>
</p>
</div>
<p>By using this benchmark scheme, we see that the
<code>gpt-4o-mini</code> model performs on least on par with typically
human screening performances. Therefore, the benchmark scheme suggests
that the model is suitable as a full seconder of the review.</p>
</div>
<div class="section level3">
<h3 id="make-judgments-over-multiple-screenings">Make judgments over multiple screenings<a class="anchor" aria-label="anchor" href="#make-judgments-over-multiple-screenings"></a>
</h3>
<p>Since we have conducted multiple (i.e., 10) screenings with the
<code>gpt-4o-mini</code> model, we can change our inclusion decision
based on the number of times a study record has been included across the
10 screening. To get this information, one can use the following
code.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incl_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">screen_performance</span>, <span class="st">"p_incl_data"</span><span class="op">)</span></span>
<span><span class="va">incl_dist</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">recall</span>, <span class="va">specificity</span>, <span class="va">criteria</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;   model       recall specificity criteria                                                        </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                                                           </span></span>
<span><span class="co">#&gt; 1 gpt-4o-mini   0.96       0.987 Studies have been included in at least 10% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 2 gpt-4o-mini   0.96       0.987 Studies have been included in at least 20% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 3 gpt-4o-mini   0.94       0.987 Studies have been included in at least 30% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 4 gpt-4o-mini   0.92       0.987 Studies have been included in at least 40% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 5 gpt-4o-mini   0.92       0.987 Studies have been included in at least 50% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 6 gpt-4o-mini   0.92       0.987 Studies have been included in at least 60% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 7 gpt-4o-mini   0.92       0.987 Studies have been included in at least 70% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 8 gpt-4o-mini   0.88       0.987 Studies have been included in at least 80% of the 10 screenings.</span></span>
<span><span class="co">#&gt; 9 gpt-4o-mini   0.84       0.987 Studies have been included in at least 90% of the 10 screenings.</span></span>
<span><span class="co">#&gt;10 gpt-4o-mini   0.74       0.987 Studies have been included in all of the 10 screenings.   </span></span></code></pre></div>
<p>From these results, it appears that we can increase the recall of the
model if we include a record when it has been included in at least 1 of
out of the 10 screenings. In this case, we would not lose anything by
doing so, since the specific measure is rarely impacted by this
change.</p>
</div>
</div>
<div class="section level2">
<h2 id="check-and-resolve-disagreements">Check and resolve disagreements<a class="anchor" aria-label="anchor" href="#check-and-resolve-disagreements"></a>
</h2>
<p>Even though, the <code>gpt-4o-mini</code> model yielded a highly
acceptable screening performance, it is relevant to assess the reasons
for disagreements between the human(s) and the GPT model. This
information can be useful to further develop ones prompt if for example
it appears that the GPT model misinterpret some conceptions.</p>
<div class="section level3">
<h3 id="getting-detailed-descriptions-for-disaggrement-records">Getting detailed descriptions for disaggrement records<a class="anchor" aria-label="anchor" href="#getting-detailed-descriptions-for-disaggrement-records"></a>
</h3>
<p>To get detailed descriptions of GPTs reasons for exclusion
(alternatively inclusion), one can set
<code>decision_description = TRUE</code>, and run the screening again,
so done below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disagree_dat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span><span class="op">$</span><span class="va">answer_data_aggregated</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">human_code</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">final_decision_gpt_num</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">incl_p</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_object_detail</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">disagree_dat</span>, </span>
<span>    prompt <span class="op">=</span> <span class="va">prompt</span>, </span>
<span>    studyid <span class="op">=</span> <span class="va">studyid</span>, </span>
<span>    title <span class="op">=</span> <span class="va">title</span>, </span>
<span>    abstract <span class="op">=</span> <span class="va">abstract</span>, </span>
<span>    model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>, </span>
<span>    rpm <span class="op">=</span> <span class="va">models_rpm</span><span class="op">$</span><span class="va">requests_per_minute</span>,</span>
<span>    decision_description <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Get detailed screening decisions</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; * The approximate price of the current (simple) screening will be around $0.0002.</span></span>
<span><span class="co">#&gt; * Be aware that getting descriptive, detailed responses will substantially </span></span>
<span><span class="co">#&gt; increase the prize of the screening relative to the noted approximate prize.</span></span>
<span><span class="co">#&gt; Progress: ───────────────────────────────────────────────────────────────── 100%</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
<p>For now, we recommend only to get detailed description for records
where the human(s) and GPT disagree because it can substantially
increases the cost of the screening with an unknown amount to get this
type of information. However, it is questionable how substantial this
issue is with the <code>gpt-4o-mini</code> model.</p>
<div class="section level4">
<h4 id="example-of-detailed-answer">Example of detailed answer<a class="anchor" aria-label="anchor" href="#example-of-detailed-answer"></a>
</h4>
<p>Here is an example of an abstract that was included by the humans and
excluded by GPT.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of abstract included by the human and excluded by gpt-4o-mini</span></span>
<span><span class="va">result_object_detail</span><span class="op">$</span><span class="va">answer_data</span><span class="op">$</span><span class="va">abstract</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Introduction: Many universal school-based preventative intervention trials </span></span>
<span><span class="co">#&gt; for anxiety have been conducted in Western countries. This pilot study examined </span></span>
<span><span class="co">#&gt; the efficacy and acceptability of a school-based, universal preventative program </span></span>
<span><span class="co">#&gt; for anxiety among children aged 8&lt;e2&gt;&lt;80&gt;&lt;93&gt;9 years in Japan. The program was </span></span>
<span><span class="co">#&gt; based on cognitive-behavioral therapy (CBT) and was informed by similar universal </span></span>
<span><span class="co">#&gt; programs (i.e., the Fun FRIENDS program; Barrett, 2007a, 2007b). Methods: Seventy-four </span></span>
<span><span class="co">#&gt; children from a single school were allocated to an intervention or control group. </span></span>
<span><span class="co">#&gt; The intervention comprised 10 CBT sessions, and assessments were conducted before </span></span>
<span><span class="co">#&gt; and after the program. The primary outcome measure was the Spence Children's Anxiety Scale (SCAS)</span></span>
<span><span class="co">#&gt; as children's self-report. Secondary outcome measures were the Depression Self-Rating </span></span>
<span><span class="co">#&gt; Scale for Children (DSRS-C), Children's Hope Scale (Hope), </span></span>
<span><span class="co">#&gt; Spence Children's Anxiety Scale-Parent Version (SCAS-P), and Strengths </span></span>
<span><span class="co">#&gt; and Difficulties Questionnaire-Parent Version (SDQ-P). Results:  The SCAS as the </span></span>
<span><span class="co">#&gt; primary outcome showed no significant differences between the two groups.</span></span>
<span><span class="co">#&gt; In addition, DSRS-C, Hope and SDQ-P also showed no significant differences. </span></span>
<span><span class="co">#&gt; SCAS-P in the intervention group showed significant decrease compared to those </span></span>
<span><span class="co">#&gt; in the control group. Conclusion: The results of this trial study suggest that </span></span>
<span><span class="co">#&gt; a school-based universal preventative  program for anxiety may have no significant </span></span>
<span><span class="co">#&gt; effects on 8&lt;e2&gt;&lt;80&gt;&lt;93&gt;9-year-old children. </span></span>
<span><span class="co">#&gt; (PsycInfo Database Record (c) 2022 APA, all rights reserved)"</span></span></code></pre></div>
<p>and this is GPTs detailed response.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of explanation for exclusion </span></span>
<span><span class="co"># Seems reasonable why the records was thrown out by gpt.</span></span>
<span><span class="va">result_object_detail</span><span class="op">$</span><span class="va">answer_data</span><span class="op">$</span><span class="va">detailed_description</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "The study does not focus on the FRIENDS preventive programme; instead, </span></span>
<span><span class="co">#&gt; it evaluates a different school-based CBT intervention and references </span></span>
<span><span class="co">#&gt; the Fun FRIENDS program without investigating its effects directly. </span></span>
<span><span class="co">#&gt; Additionally, it assesses a general anxiety intervention rather than </span></span>
<span><span class="co">#&gt; specifically measuring the FRIENDS programme's effectiveness."</span></span></code></pre></div>
<p>As can be seen from this answer, it is reasonable why the title and
abstract has not been included by GPT since it is stated in the abstract
that the intervention was only informed by the Fun Friends program, but
is different from it. Although, this is not a clear-cut example, it
indicates that it is always important also to test that a low recall
measure is not driven by insufficient human screening.</p>
<p><em>NOTE</em>: When re-screening disagreements, it might happen (due
to uncertainty in the models) that some (near miss) studies will be
included, although they were excluded in the first screening. These
studies could just be added to the pool of included studies.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="approximate-price-of-full-scale-screening">Approximate price of full-scale screening<a class="anchor" aria-label="anchor" href="#approximate-price-of-full-scale-screening"></a>
</h2>
<p>When you have decided to use a GPT model as your second screener, you
would probably like know how much you have to pay for the full
screening. This information can be obtained by using
<code><a href="../reference/approximate_price_gpt.html">approximate_price_gpt()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All ris-file data</span></span>
<span><span class="va">all_dat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ris_dat_excl</span>, <span class="va">ris_dat_incl</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Use RIS-file data here</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstract</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Only screen studies with an abstract</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>studyid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">app_obj</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/approximate_price_gpt.html">approximate_price_gpt</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">all_dat</span>, </span>
<span>    prompt <span class="op">=</span> <span class="va">prompt</span>, </span>
<span>    studyid <span class="op">=</span> <span class="va">studyid</span>, </span>
<span>    title <span class="op">=</span> <span class="va">title</span>, </span>
<span>    abstract <span class="op">=</span> <span class="va">abstract</span>, </span>
<span>    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpt-4o-mini"</span>, <span class="st">"gpt-4"</span><span class="op">)</span>, <span class="co"># To compare model prizes</span></span>
<span>    reps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">app_obj</span></span>
<span><span class="co">#&gt; The approximate price of the (simple) screening will be around $64.1443.</span></span>
<span></span>
<span><span class="va">app_obj</span><span class="op">$</span><span class="va">price_dollar</span></span>
<span><span class="co">#&gt; [1] 64.1443</span></span>
<span><span class="va">app_obj</span><span class="op">$</span><span class="va">price_data</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 6</span></span>
<span><span class="co">#&gt;   prompt   model       iterations input_price_dollar output_price_dollar total_price_dollar</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;              &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Prompt 1 gpt-4o-mini         10               2.99               0.111               3.11</span></span>
<span><span class="co">#&gt; 2 Prompt 1 gpt-4                1              59.9                1.11               61.0  </span></span></code></pre></div>
<p>When looking at the price, it is clear why one wants to prioritize
the use of <code>gpt-4o mini</code>. One could conduct 100 screenings
with the <code>gpt-4o-mini</code> model, and it would still be half the
price of using <code>gpt-4</code>.</p>
</div>
<div class="section level2">
<h2 id="future-package-updates">Future package updates<a class="anchor" aria-label="anchor" href="#future-package-updates"></a>
</h2>
<p>In this vignette, we have shown the first step of conducting an title
and abstract screening with a GPT API model. In future versions of the
package, we will add further articles, showing:</p>
<ol style="list-style-type: decimal">
<li>How to run the full screening of all titles and abstracts most
efficiently.</li>
<li>How to fine-tune a model.</li>
<li>How to use multiple-prompt screening, that is making one prompt per
inclusion criteria.</li>
<li>New functions to assess and resolve disagreements between human and
GPT decisions.</li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Alshami2023" class="csl-entry">
Alshami, A., Elsayed, M., Ali, E., Eltoukhy, A. E. E., &amp; Zayed, T.
(2023). <span class="nocase">Harnessing the power of ChatGPT for
automating systematic review process: Methodology, case study,
limitations, and future directions</span>. <em>Systems</em>,
<em>11</em>(7), 351. <a href="https://doi.org/10.3390/systems11070351" class="external-link">https://doi.org/10.3390/systems11070351</a>
</div>
<div id="ref-Filges2024" class="csl-entry">
Filges, T., Smedslund, G., Eriksen, T., Birkefoss, K., &amp; Kildemoes,
M. W. (2024). <span class="nocase">The FRIENDS preventive programme for
reducing anxiety symptoms in children and adolescents: A systematic
review and meta-analysis</span>. <em>Campbell Systematic Reviews</em>,
<em>20</em>(4), e1443. <a href="https://doi.org/10.1002/cl2.1443" class="external-link">https://doi.org/10.1002/cl2.1443</a>
</div>
<div id="ref-Gargari2024" class="csl-entry">
Gargari, O. K., Mahmoudi, M. H., Hajisafarali, M., &amp; Samiee, R.
(2024). <span class="nocase">Enhancing title and abstract screening for
systematic reviews with GPT-3.5 turbo</span>. <em>BMJ Evidence-Based
Medicine</em>, <em>29</em>(1), 69 LP–70. <a href="https://doi.org/10.1136/bmjebm-2023-112678" class="external-link">https://doi.org/10.1136/bmjebm-2023-112678</a>
</div>
<div id="ref-Guo2024" class="csl-entry">
Guo, E., Gupta, M., Deng, J., Park, Y.-J., Paget, M., &amp; Naugler, C.
(2024). <span class="nocase">Automated paper screening for clinical
reviews using large language models: Data analysis study</span>. <em>J
Med Internet Res</em>, <em>26</em>, e48996. <a href="https://doi.org/10.2196/48996" class="external-link">https://doi.org/10.2196/48996</a>
</div>
<div id="ref-Issaiy2024" class="csl-entry">
Issaiy, M., Ghanaati, H., Kolahi, S., Shakiba, M., Jalali, A. H., Zarei,
D., … Firouznia, K. (2024). <span class="nocase">Methodological insights
into ChatGPT’s screening performance in systematic reviews</span>.
<em>BMC Medical Research Methodology</em>, <em>24</em>(1), 78. <a href="https://doi.org/10.1186/s12874-024-02203-8" class="external-link">https://doi.org/10.1186/s12874-024-02203-8</a>
</div>
<div id="ref-Khraisha2024" class="csl-entry">
Khraisha, Q., Put, S., Kappenberg, J., Warraitch, A., &amp; Hadfield, K.
(2024). <span class="nocase">Can large language models replace humans in
systematic reviews? Evaluating GPT-4’s efficacy in screening and
extracting data from peer-reviewed and grey literature in multiple
languages</span>. <em>Research Synthesis Methods</em>. <a href="https://doi.org/10.1002/jrsm.1715" class="external-link">https://doi.org/10.1002/jrsm.1715</a>
</div>
<div id="ref-Polanin2019" class="csl-entry">
Polanin, J. R., Pigott, T. D., Espelage, D. L., &amp; Grotpeter, J. K.
(2019). <span class="nocase">Best practice guidelines for abstract
screening large-evidence systematic reviews and meta-analyses</span>.
<em>Research Synthesis Methods</em>, <em>10</em>(3), 330–342. <a href="https://doi.org/10.1002/jrsm.1354" class="external-link">https://doi.org/10.1002/jrsm.1354</a>
</div>
<div id="ref-Syriani2023" class="csl-entry">
Syriani, E., David, I., &amp; Kumar, G. (2023). <span class="nocase">Assessing the ability of ChatGPT to screen articles for
systematic reviews</span>. <em>arXiv Preprint arXiv:2307.06464</em>.
</div>
<div id="ref-Syriani2024" class="csl-entry">
Syriani, E., David, I., &amp; Kumar, G. (2024). <span class="nocase">Screening articles for systematic reviews with
ChatGPT</span>. <em>Journal of Computer Languages</em>, <em>80</em>,
101287. https://doi.org/<a href="https://doi.org/10.1016/j.cola.2024.101287" class="external-link">https://doi.org/10.1016/j.cola.2024.101287</a>
</div>
<div id="ref-Vembye2024_gpt" class="csl-entry">
Vembye, M. H., Christensen, J., Mølgaard, A. B., &amp; Schytt, F. L. W.
(2024). <span class="nocase">GPT API Models Can Function as Highly
Reliable Second Screeners of Titles and Abstracts in Systematic Reviews:
A Proof of Concept and Common Guidelines</span>. <em>Open Science
Framework</em>. <a href="https://doi.org/10.31219/osf.io/yrhzm" class="external-link">https://doi.org/10.31219/osf.io/yrhzm</a>
</div>
<div id="ref-westgate2019" class="csl-entry">
Westgate, M. J. (2019). <span class="nocase">revtools: An R package to
support article screening for evidence synthesis</span>. <em>Research
Synthesis Methods</em>, <em>10</em>(4), 606–614. <a href="https://doi.org/10.1002/jrsm.1374" class="external-link">https://doi.org/10.1002/jrsm.1374</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mikkel H. Vembye.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
