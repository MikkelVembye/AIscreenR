<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews • AIscreenR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AIscreenR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Using-GPT-API-Models-For-Screening.html">Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MikkelVembye/AIscreenR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using OpenAI's GPT API models for Title and Abstract Screening in Systematic Reviews</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MikkelVembye/AIscreenR/blob/main/vignettes/Using-GPT-API-Models-For-Screening.Rmd" class="external-link"><code>vignettes/Using-GPT-API-Models-For-Screening.Rmd</code></a></small>
      <div class="d-none name"><code>Using-GPT-API-Models-For-Screening.Rmd</code></div>
    </div>

    
    
<div class="warning" style="margin-left:2em; margin-right:2em; margin-bottom:2em; margin-top:2em; padding:0.1em; background-color: #d7dbdd; border: solid #bdc3c7 3px">
<span>
<p style="margin-top:1em; text-align:center">
<b>Important note</b>
</p>
<p style="margin:1em">
This is work-in-progress only. For now, see Vembye et al. (2024) for an
overview of how and when GPT API models can be used for title and
abstract (TAB) screening. For an overview of other research regarding
the use of GPT API models for title and abstract screening, see Syriani
et al. (2023), Guo et al., (2024), and Gargari et al. (2024). On a
related line of research, Alshami et al. (2023), Khraisha et al. (2024),
and Issaiy et al. (2024) explored using the ChatGPT web browser
interface for TAB screening. Based on our experience, we think that
these two lines of research should not be mixed up since the draw on
different GPT models.
</p>
<p></p></span>
</div>
<p>In this vignette, we show how to conduct title and abstract screening
with OpenAI’s GPT API models in R. The advantages of conducting the
screening with GPT API models via R is 1) that reviewers can easily work
with a large number of references, avoiding copy-paste procedures
(cf. Khraisha et al., 2024), 2) that the total screening time can be
substantially decreased relative to using the ChatGPT interface, since
screenings can be done in parallel, 3) that it eases model comparison,
and 4) that consistency between GPT answer for the same title and
abstract can easily be tested. It is important to stress that the GPT
API models used for TAB screening should always be use carefully and be
assisted by a human (human-in-the-loop). Consequently, we do not
recommend to use the <code>AIscreenR</code> as a single screener, unless
this an absolutely final solution. .</p>
<div class="section level3">
<h3 id="getting-started-loading-relevant-ris-file-data-for-screening">Getting started: Loading relevant ris file data for screening<a class="anchor" aria-label="anchor" href="#getting-started-loading-relevant-ris-file-data-for-screening"></a>
</h3>
<p>At this stage, we expect that you have a pile of ris-files,
containing titles and abstracts for the references you would like to
screen. You can retrieve ris-files in several ways, either directly from
research database, a Google Scholar search, or exported from your
reference management tool, such as EndNote, Mendeley, and RefMan.
Alternatively, you can export ris-file from systematic software tool
such as <a href="https://eppi.ioe.ac.uk/EPPIReviewer-Web/home" class="external-link">EPPI-reviewer</a>,
<a href="https://www.covidence.org/" class="external-link">Covidence</a>, <a href="https://www.metareviewer.org/" class="external-link">MetaReviewer</a>, <a href="http://www.eshackathon.org/revtools/" class="external-link"><code>revtools</code></a>,
or whatever software you use. In the example given below, we load
ris-files extracted from the <a href="https://eppi.ioe.ac.uk/cms/Default.aspx?tabid=2914" class="external-link">EPPI-reviewer</a>.
A minor advantage of extracting ris-files from systematic software tools
is that they add a unique study ID to each reference. This feature makes
it easier to keep track of the screening. Yet, such IDs are
automatically generated in the <code><a href="../reference/tabscreen_gpt.tools.html">tabscreen_gpt()</a></code> function if
unique IDs are missing. When using a GPT API model as the second
screener, we recommend that the human screening has been done before
uploading ris-file(s) to R. Thereby, it is possible to compare the
screenings instantly after the computer screening has been done. In the
below example we load ris-files separately for excluded and included
ris-files, respectively, and add the <code>human_code</code> variable to
track the human decision.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading packages </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikkelvembye.github.io/AIscreenR/">AIscreenR</a></span><span class="op">)</span> <span class="co"># Used to screen and calculate gpt vs. human performance</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://revtools.net" class="external-link">revtools</a></span><span class="op">)</span>  <span class="co"># Used to load ris-files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>    <span class="co"># Used to work with tibbles</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>     <span class="co"># Used to work with tibbles</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org" class="external-link">usethis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span>    <span class="co"># Used to conduct screenings in parallel</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reading path to risfiles</span></span>
<span><span class="va">excl_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"excl_tutorial.ris"</span>, package <span class="op">=</span> <span class="st">"AIscreenR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loading EXCLUDED studies</span></span>
<span><span class="va">ris_dat_excl</span> <span class="op">&lt;-</span> <span class="fu">revtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/revtools/man/read_bibliograpy.html" class="external-link">read_bibliography</a></span><span class="op">(</span><span class="va">excl_path</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">eppi_id</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Using only relevant variables</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    human_code <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Loading INCLUDED studies</span></span>
<span><span class="va">incl_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"incl_tutorial.ris"</span>, package <span class="op">=</span> <span class="st">"AIscreenR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ris_dat_incl</span> <span class="op">&lt;-</span> <span class="fu">revtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/revtools/man/read_bibliograpy.html" class="external-link">read_bibliography</a></span><span class="op">(</span><span class="va">incl_path</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">eppi_id</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    human_code <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">author</span>, <span class="va">title</span>, <span class="va">abstract</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">filges2015_dat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ris_dat_excl</span>, <span class="va">ris_dat_incl</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    studyid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">studyid</span>, .after <span class="op">=</span> <span class="va">eppi_id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">filges2015_dat</span></span>
<span><span class="co">#&gt; # A tibble: 270 × 6</span></span>
<span><span class="co">#&gt;   author                       eppi_id studyid title abstract human_code</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                        &lt;chr&gt;     &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Holloway R G and Gramling R… 9434957       1 Esti… "Progno…          0</span></span>
<span><span class="co">#&gt; 2 Morawska Alina and Stallman… 9433838       2 Self… "Behavi…          0</span></span>
<span><span class="co">#&gt; 3 Michel C M and Pascual-Marq… 9431171       3 Freq… "The to…          0</span></span>
<span><span class="co">#&gt; 4 Paul Howard A                9433968       4 A Re… "The ar…          0</span></span>
<span><span class="co">#&gt; 5 Feinberg I and De Bie E and… 9434460       5 Topo… "STUDY …          0</span></span>
<span><span class="co">#&gt; 6 Hamburg Sam R                9433554       6 BOOK… "The ar…          0</span></span>
<span><span class="co">#&gt; 7 Park H Y and Lee B J and Ki… 9435130       7 Rapi… "Backgr…          0</span></span>
<span><span class="co">#&gt; 8 Petrek J                     9432040       8 Pict… "AIMS: …          0</span></span>
<span><span class="co">#&gt; 9 Schwartzman Meredith P and … 9434093       9 Enha… "New an…          0</span></span>
<span><span class="co">#&gt;10 Faber J and Srutova L and P… 9431505      10 EEG … "Sponta…          0</span></span>
<span><span class="co">#&gt;# ℹ 260 more rows</span></span>
<span><span class="co">#&gt;# ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-api-key-openai">Getting API key (OpenAI)<a class="anchor" aria-label="anchor" href="#getting-api-key-openai"></a>
</h3>
<p>Before you can use the <code>AIscreenR</code> to screen your
references, you must generate your own secret API key from OpenAI. To do
so you must first ensure that you have created an account at OpenAI
(<em>if you have not done so at this stage, you can sign up <a href="https://auth0.openai.com/u/login/identifier?state=hKFo2SBqQjNHSlc1ejIyREpUb01hdDF2OHEzQy12NnJwWlFUN6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIEJSOWJaamdKLWswNGlfWDQ2NER1OXJmVUNpVmVzVjZfo2NpZNkgRFJpdnNubTJNdTQyVDNLT3BxZHR3QjNOWXZpSFl6d0Q" class="external-link">here</a>).</em>
When having an account, go to <a href="https://platform.openai.com/account/api-keys" class="external-link">https://platform.openai.com/account/api-keys</a>
and press the <code>+ Create new secret key</code> button (see Figure 1
below) and give your key a name.</p>
<p> </p>
<div class="figure">
<img src="helper-stuff%2FAPI_key_pic.png" alt="*Figure 1 - Generate API key from OpenAI*" width="100%"><p class="caption">
<em>Figure 1 - Generate API key from OpenAI</em>
</p>
</div>
<p> </p>
<p>When you have generated your secret API key, remember to store it
safely since you will not be able see it again. <strong>NOTE</strong>:
<em>If you lose your API key, you can just generate a new one</em>.</p>
</div>
<div class="section level3">
<h3 id="handling-your-api-key">Handling your API key<a class="anchor" aria-label="anchor" href="#handling-your-api-key"></a>
</h3>
<p>When you have retrieved your API, you could in theory add it directly
to the <code>AIscreenR</code> functions via the <code>api_key</code>
argument. Yet, this would be an improper way to work the API key since
you would easily compromise your secret key. For example, your API key
would be disclosed when sharing your codes with others, which gives them
access to draw on your OpenAI account. Furthermore, OpenAI will cancel
the API key if they recognize that your API key has been compromised
(e.g., if you push it to a public GitHub page). To overcome this issue
you have several options from here. You can either work with what we
call permanent or temporary solutions.</p>
<div class="section level4">
<h4 id="permanent-solution">Permanent solution<a class="anchor" aria-label="anchor" href="#permanent-solution"></a>
</h4>
<p>The easiest way to work with your API key is to permanently add it to
your R environment as an environment variable. This can be achieved with
<code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>. In the <code>.Renviron</code>
file, write <code>CHATGPT_KEY=your_key</code> as depicted in Figure 2.
After entering the API key, close and save the <code>.Renviron</code>
file and restart <code>RStudio</code> (ctrl + shift + F10). From now on,
the <code>AIscreenR</code> functions will use the
<code><a href="../reference/get_api_key.html">get_api_key()</a></code> function to retrieve your API key from your R
environment automatically. By using this approach you don’t have to
worry more about you API key (unless you update RStudio, deliberately
delete the key, or get a new computer. Then you must repeat this
process).  </p>
<div class="figure">
<img src="helper-stuff%2FRenviron.png" alt="*Figure 2 - R environment file*" width="100%"><p class="caption">
<em>Figure 2 - R environment file</em>
</p>
</div>
<p> </p>
</div>
<div class="section level4">
<h4 id="temporary-solution">Temporary solution<a class="anchor" aria-label="anchor" href="#temporary-solution"></a>
</h4>
<p>If you do not want to add you API key permanently to your R
environment, you can use <code><a href="../reference/set_api_key.html">set_api_key()</a></code>. When executing
<code><a href="../reference/set_api_key.html">set_api_key()</a></code>, you will see a pop-up window in which you
can enter your API key. This will add your API key as temporary
environment variable. Consequently, when you restart RStudio, you will
no longer be able to find your API key in your R environment.
Alternatively, you can pass a decrypted key to the
<code><a href="../reference/set_api_key.html">set_api_key()</a></code>, like
<code>set_api_key(key = secret_decrypt(encrypt_key, "YOUR_SECRET_KEY_FOR_DECRYTING"))</code>.
See the <a href="https://httr2.r-lib.org/articles/wrapping-apis.html#basics" class="external-link"><code>HTTR2</code></a>
package for further details about this solution.  </p>
<div class="figure">
<img src="helper-stuff%2Fset_api.png" alt="*Figure 3 - Set API key*" width="100%"><p class="caption">
<em>Figure 3 - Set API key</em>
</p>
</div>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="working-with-prompts-in-r">Working with prompts in R<a class="anchor" aria-label="anchor" href="#working-with-prompts-in-r"></a>
</h3>
<p>Example of how to enter a prompt.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prompt</span> <span class="op">&lt;-</span> <span class="st">"Evaluate the following study based on the selection criteria</span></span>
<span><span class="st">for a systematic review on the effects of family-based interventions on drug </span></span>
<span><span class="st">abuse reduction for young people in treatment for non-opioid drug use.</span></span>
<span><span class="st">A family-based intervention (FFT) is equivalent to a behavior focused</span></span>
<span><span class="st">family therapy, where young people’s drug use is understood in relation to </span></span>
<span><span class="st">family behavior problems. Family-based interventions also includes manual-based </span></span>
<span><span class="st">family therapies as it targets young people and their families as a system </span></span>
<span><span class="st">throughout treatment, and thereby recognizes the important role of the family </span></span>
<span><span class="st">system in the development and treatment of young people’s drug use problems. </span></span>
<span><span class="st">FFT was developed in the late 1980s on request from the US National Institute on</span></span>
<span><span class="st">Drug Abuse (NIDA). The development of FFT was initially heavily inspired by the </span></span>
<span><span class="st">alcohol abuse program Community Reinforcement Approach (CRA), which was aimed </span></span>
<span><span class="st">at restructuring the environment to reinforce non-alcohol associated activities. </span></span>
<span><span class="st">FFT developed to have more emphasis on contingency contracting, impulse control </span></span>
<span><span class="st">strategies specific to drug use, and increased emphasis on involvement of family </span></span>
<span><span class="st">members in treatment. FFT is designed to accommodate diverse populations of </span></span>
<span><span class="st">youths with a variety of behavioral, cultural and individual preferences. </span></span>
<span><span class="st">FFT has evolved for use in severe behavioral disturbances known to co-exist with</span></span>
<span><span class="st">substance use and dependence, and the core interventions have been enhanced to </span></span>
<span><span class="st">address several mental health related problems commonly occurring</span></span>
<span><span class="st">as comorbid conditions in drug use treatment participant.  For each study,</span></span>
<span><span class="st">I would like you to assess:  1) Is the study about a family-based intervention,</span></span>
<span><span class="st">such as Functional Family Therapy, Multidimensional Family Therapy, or</span></span>
<span><span class="st">Behavioral Family Therapy? (Outpatient manual-based interventions of any</span></span>
<span><span class="st">duration delivered to young people and their families). If not, exclude study.</span></span>
<span><span class="st">2) Are the participants in outpatient drug treatment primarily</span></span>
<span><span class="st">for non-opioid drug use? 3) Are the participants within age 11–21?"</span></span></code></pre></div>
<p>Can also be done in word</p>
<p> </p>
<div class="figure">
<img src="helper-stuff%2Fwordprompt1.png" alt="*Figure 4 - Prompt 1: With three inclusion critera.*" width="100%"><p class="caption">
<em>Figure 4 - Prompt 1: With three inclusion critera.</em>
</p>
</div>
<p> </p>
<p> </p>
<div class="figure">
<img src="helper-stuff%2Fwordprompt2.png" alt="*Figure 5 - Prompt 2: With one inclusion criterion only.*" width="100%"><p class="caption">
<em>Figure 5 - Prompt 2: With one inclusion criterion only.</em>
</p>
</div>
<p> </p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">word_path</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"word_prompt_1.docx"</span>, package <span class="op">=</span> <span class="st">"AIscreenR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prompt1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">readtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readtext/man/readtext.html" class="external-link">readtext</a></span><span class="op">(</span><span class="va">word_path</span><span class="op">)</span><span class="op">$</span><span class="va">text</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove_all</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prompt1</span></span>
<span></span>
<span><span class="co"># Working with multiple prompts</span></span>
<span><span class="va">word_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"word_prompt_1.docx"</span>, <span class="st">"word_prompt_2.docx"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"AIscreenR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prompts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span></span>
<span>    <span class="va">word_paths</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>      <span class="fu">readtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readtext/man/readtext.html" class="external-link">readtext</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">$</span><span class="va">text</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove_all</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prompts</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="retrieve-rate-limit-information">Retrieve rate limit information<a class="anchor" aria-label="anchor" href="#retrieve-rate-limit-information"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rate limits across one model (Default is "gpt-3.5-turbo-0613")</span></span>
<span><span class="va">rate_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rate_limits_per_minute.html">rate_limits_per_minute</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rate_limits</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   model              requests_per_minute tokens_per_minute</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                            &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 gpt-3.5-turbo-0613               10000           1000000</span></span>
<span></span>
<span></span>
<span><span class="co"># Rate limits overview across multiple models</span></span>
<span><span class="co"># Add further models if necessary</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpt-3.5-turbo-0613"</span>, <span class="st">"gpt-4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">models_rate_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rate_limits_per_minute.html">rate_limits_per_minute</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">models</span><span class="op">)</span> </span>
<span><span class="va">models_rate_limits</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   model              requests_per_minute tokens_per_minute</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                            &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 gpt-3.5-turbo-0613               10000           1000000</span></span>
<span><span class="co">#&gt; 2 gpt-4                              200             10000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="approximate-price-of-screening">Approximate price of screening<a class="anchor" aria-label="anchor" href="#approximate-price-of-screening"></a>
</h3>
<p>Approximate price of screening</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app_obj</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/approximate_price_gpt.html">approximate_price_gpt</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">filges2015_dat</span>, <span class="co"># Tutorial data embedded in the package</span></span>
<span>    prompt <span class="op">=</span> <span class="va">prompts</span>, </span>
<span>    studyid <span class="op">=</span> <span class="va">studyid</span>, <span class="co"># indicate the variable with the studyid in the data</span></span>
<span>    title <span class="op">=</span> <span class="va">title</span>, <span class="co"># indicate the variable with the titles in the data</span></span>
<span>    abstract <span class="op">=</span> <span class="va">abstract</span>, <span class="co"># indicate the variable with the abstracts in the data</span></span>
<span>    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpt-4o"</span>, <span class="st">"gpt-4"</span><span class="op">)</span>,</span>
<span>    reps <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">app_obj</span></span>
<span><span class="co">#&gt; The approximate price of the (simple) screening will be around $3.0573.</span></span>
<span></span>
<span><span class="va">app_obj</span><span class="op">$</span><span class="va">price_dollar</span></span>
<span><span class="co">#&gt; [1] 3.0573</span></span>
<span><span class="va">app_obj</span><span class="op">$</span><span class="va">price_data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="screening-titles-and-abstracts">Screening titles and abstracts<a class="anchor" aria-label="anchor" href="#screening-titles-and-abstracts"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpt-3.5-turbo-0613"</span>, <span class="st">"gpt-3.5-turbo-0613"</span>, <span class="st">"gpt-4"</span><span class="op">)</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_object</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/tabscreen_gpt.original.html">tabscreen_gpt.original</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">filges2015_dat</span>, <span class="co"># ris-file data create above </span></span>
<span>    prompt <span class="op">=</span> <span class="va">prompt</span>, <span class="co"># indicate name of the loaded prompt object</span></span>
<span>    studyid <span class="op">=</span> <span class="va">studyid</span>, <span class="co"># indicate the variable with the studyid in the data</span></span>
<span>    title <span class="op">=</span> <span class="va">title</span>, <span class="co"># indicate the variable with the titles in the data</span></span>
<span>    abstract <span class="op">=</span> <span class="va">abstract</span>, <span class="co"># indicate the variable with the abstracts in the data,</span></span>
<span>    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpt-3.5-turbo-0613"</span>, <span class="st">"gpt-3.5-turbo-0613"</span>, <span class="st">"gpt-4"</span><span class="op">)</span>,</span>
<span>    reps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    rpm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>    top_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; * The approximate price of the current (simple) screening will be around $27.9901.</span></span>
<span><span class="co">#&gt; * Consider removing references that has no abstract since these can distort the accuracy of the screening</span></span>
<span><span class="co">#&gt;  Progress: ──────────────────────────────────────────────────────────────────────────────────────────── 100%</span></span>
<span><span class="co">#&gt;  * NOTE: Requests failed 4 times."</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Find data with all answers by executing</span></span>
<span><span class="co">#&gt;  result_object$answer_data_all</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find data with the result aggregated across multiple answers by executing</span></span>
<span><span class="co">#&gt;  result_object$answer_data_sum</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find total price for the screening by executing</span></span>
<span><span class="co">#&gt;  result_object$price_dollar</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find error data by executing</span></span>
<span><span class="co">#&gt;  result_object$error_data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="screen-failed-requests">Screen failed requests<a class="anchor" aria-label="anchor" href="#screen-failed-requests"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_object</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/screen_errors.html">screen_errors</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Find data with all answers by executing</span></span>
<span><span class="co">#&gt;  result_object$answer_data_all</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find data with the result aggregated across multiple answers by executing</span></span>
<span><span class="co">#&gt;  result_object$answer_data_sum</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find total price for the screening by executing</span></span>
<span><span class="co">#&gt;  result_object$price_dollar</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-the-results-from-the-screening">Getting the results from the screening<a class="anchor" aria-label="anchor" href="#getting-the-results-from-the-screening"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gpt-3.5 results (prompt 1, top_p = 1, 10 replications)</span></span>
<span><span class="co"># studyid = 21 is not included since it failed during the loop</span></span>
<span><span class="co"># I show how to recover this in another </span></span>
<span><span class="va">sum_dat_gpt3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span><span class="op">$</span><span class="va">answer_data_sum</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"3"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">promptid</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">reps</span> <span class="op">==</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">top_p</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># gpt-4 results (prompt 1, top_p = 1)</span></span>
<span><span class="va">sum_dat_gpt4</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span><span class="op">$</span><span class="va">answer_data_sum</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"4"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">promptid</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">top_p</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyzing-the-screening">Analyzing the screening<a class="anchor" aria-label="anchor" href="#analyzing-the-screening"></a>
</h3>
<div class="section level4">
<h4 id="simple-table">Simple table<a class="anchor" aria-label="anchor" href="#simple-table"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gpt3.5 result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>gpt <span class="op">=</span> <span class="va">sum_dat_gpt3</span><span class="op">$</span><span class="va">final_decision_gpt_num</span>, human <span class="op">=</span> <span class="va">sum_dat_gpt3</span><span class="op">$</span><span class="va">human_code</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>gpt <span class="op">=</span> <span class="va">sum_dat_gpt4</span><span class="op">$</span><span class="va">final_decision_gpt_num</span>, human <span class="op">=</span> <span class="va">sum_dat_gpt4</span><span class="op">$</span><span class="va">human_code</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="false-included-and-excluded-by-gpt">False included and excluded (by gpt)<a class="anchor" aria-label="anchor" href="#false-included-and-excluded-by-gpt"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">screen_perform</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">result_object</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/screen_analyzer.html">screen_analyzer</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">screen_perform</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="getting-detailed-descriptions">Getting detailed descriptions<a class="anchor" aria-label="anchor" href="#getting-detailed-descriptions"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show example with gpt-4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Alshami, A., Elsayed, M., Ali, E., Eltoukhy, A. E. E., &amp; Zayed,
T. (2023). Harnessing the power of ChatGPT for automating systematic
review process: Methodology, case study, limitations, and future
directions. <em>Systems</em>. 11(7).</p>
<p>Gargari, O. K., Mahmoudi, M. H., Hajisafarali, M., &amp; Samiee, R.
(2024). Enhancing title and abstract screening for systematic reviews
with GPT-3.5 turbo. <em>BMJ Evidence-Based Medicine</em>, 29(1), 69 LP –
70. <a href="https://doi.org/10.1136/bmjebm-2023-112678" class="external-link uri">https://doi.org/10.1136/bmjebm-2023-112678</a></p>
<p>Guo, E., Gupta, M., Deng, J., Park, Y.-J., Paget, M., &amp; Naugler,
C. (2024). Automated Paper Screening for Clinical Reviews Using Large
Language Models: Data Analysis Study. <em>Journal of Medical Internet
Research</em>. <a href="https://doi.org/10.2196/48996" class="external-link uri">https://doi.org/10.2196/48996</a></p>
<p>Issaiy, M., Ghanaati, H., Kolahi, S., Shakiba, M., Jalali, A. H.,
Zarei, D., Kazemian, S., Avanaki, M. A., &amp; Firouznia, K. (2024).
Methodological insights into ChatGPT’s screening performance in
systematic reviews. <em>BMC Medical Research Methodology</em>, 24(1),
78. <a href="https://doi.org/10.1186/s12874-024-02203-8" class="external-link uri">https://doi.org/10.1186/s12874-024-02203-8</a></p>
<p>Khraisha Q, Put S, Kappenberg J, Warraitch A, Hadfield K (2024). Can
large language models replace humans in systematic reviews? Evaluating
GPT-4’s efficacy in screening and extracting data from peer-reviewed and
grey literature in multiple languages. <em>Research Synthesis
Methods</em>. 1-11. <a href="https://doi.org/10.1002/jrsm.1715" class="external-link uri">https://doi.org/10.1002/jrsm.1715</a></p>
<p>Syriani, E., David, I., &amp; Kumar, G. (2023). Assessing the Ability
of ChatGPT to Screen Articles for Systematic Reviews. <em>ArXiv Preprint
ArXiv:2307.06464.</em> <a href="http://arxiv.org/pdf/2307.06464" class="external-link uri">http://arxiv.org/pdf/2307.06464</a></p>
<p>Vembye, M., Christensen, J., Mølgaard, A. B., Schytt, F.L.W. (2024).
GPT API Models Can Function as Highly Reliable Second Screeners of
Titles and Abstracts in Systematic Reviews: A Proof of Concept and
Common Guidelines. <em>Open Science Framework (OSF)</em>. <a href="https://doi.org/10.31219/osf.io/yrhzm" class="external-link uri">https://doi.org/10.31219/osf.io/yrhzm</a></p>
<p>Westgate MJ (2019). revtools: An R package to support article
screening for evidence synthesis. <em>Research Synthesis Methods</em>.
<a href="https://doi.org/10.1002/jrsm.1374" class="external-link uri">https://doi.org/10.1002/jrsm.1374</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mikkel H. Vembye.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
