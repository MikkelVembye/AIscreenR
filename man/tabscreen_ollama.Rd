% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabscreen_ollama.r
\encoding{UTF-8}
\name{tabscreen_ollama}
\alias{tabscreen_ollama}
\title{Title and abstract screening with Ollama API models using function calls}
\usage{
tabscreen_ollama(
  data,
  prompt,
  studyid,
  title,
  abstract,
  ...,
  model = "llama3.2",
  role = "user",
  tools = NULL,
  tool_choice = NULL,
  top_p = 1,
  time_info = TRUE,
  token_info = TRUE,
  max_tries = 16,
  max_seconds = NULL,
  backoff = NULL,
  after = NULL,
  rpm = 10000,
  reps = 1,
  seed_par = NULL,
  progress = TRUE,
  decision_description = FALSE,
  messages = TRUE,
  incl_cutoff_upper = NULL,
  incl_cutoff_lower = NULL,
  force = FALSE
)
}
\arguments{
\item{data}{Data frame containing studies to screen.}

\item{prompt}{Character vector of screening prompts.}

\item{studyid}{Study ID column or vector.}

\item{title}{Title column or vector.}

\item{abstract}{Abstract column or vector.}

\item{...}{Additional arguments passed to the request body.}

\item{model}{Character string or vector with the name(s) of the Ollama model(s). Default: "llama3.2".}

\item{role}{Character string indicating the role of the user. Default: "user".}

\item{tools}{List of function definitions for tool calling. Default is set based on \code{decision_description}.}

\item{tool_choice}{Specification for which tool to use. Default is set based on \code{decision_description}.}

\item{top_p}{Numeric. Nucleus sampling parameter. Default: 1.}

\item{time_info}{Logical. Include run time for each request. Default: TRUE.}

\item{token_info}{Logical. Include token counts and price info. Default: TRUE.}

\item{max_tries}{Integer. Maximum number of request attempts. Default: 16.}

\item{max_seconds}{Numeric. Maximum total elapsed time for retries.}

\item{backoff}{Function for backoff strategy.}

\item{after}{Function for wait time after response.}

\item{rpm}{Integer or vector. Requests per minute per model. Default: 10000.}

\item{reps}{Integer or vector. Number of repeated questions per study. Default: 1.}

\item{seed_par}{Numeric. Seed for reproducible parallel random numbers.}

\item{progress}{Logical. Show progress bar. Default: TRUE.}

\item{decision_description}{Logical. Include detailed decision descriptions. Default: FALSE.}

\item{messages}{Logical. Print function messages. Default: TRUE.}

\item{incl_cutoff_upper}{Numeric. Probability threshold for inclusion. Default: 0.5.}

\item{incl_cutoff_lower}{Numeric. Probability threshold for human check. Default: 0.4.}

\item{force}{Logical. Allow more than 10 reps. Default: FALSE.}
}
\value{
An object of class "ollama", a list containing:
\describe{
\item{answer_data_aggregated}{Aggregated inclusion decisions (if reps > 1).}
\item{answer_data}{All individual answers.}
\item{price_dollar}{Total price (USD) of screening.}
\item{price_data}{Prices per model.}
\item{error_data}{Failed requests (if any).}
\item{run_date}{Date of screening.}
}
}
\description{
Conducts title and abstract screening using Ollama-hosted models (e.g., Llama 3, Mixtral, Gemma, DeepSeek, Qwen, and fine-tuned models).
Supports multiple prompts, repeated questions for consistency checks, and parallel execution.
Uses function calling via the \code{tools} argument for reliable responses.
See Vembye et al. (2025) for guidance on screening with Ollama models.
}
\examples{
\dontrun{
prompt <- "Is this study about a Functional Family Therapy (FFT) intervention?"
plan(multisession)
tabscreen_ollama(
  data = filges2015_dat[1:2,],
  prompt = prompt,
  studyid = studyid,
  title = title,
  abstract = abstract,
  model = "llama3.2",
  max_tries = 2
)
plan(sequential)

# Get detailed descriptions of the decisions
plan(multisession)
tabscreen_ollama(
  data = filges2015_dat[1:2,],
  prompt = prompt,
  studyid = studyid,
  title = title,
  abstract = abstract,
  model = "llama3.2",
  decision_description = TRUE,
  max_tries = 2
)
plan(sequential)
}
}
\references{
Vembye, M. H., Christensen, J., MÃ¸lgaard, A. B., & Schytt, F. L. W. (2024).
GPT API Models Can Function as Highly Reliable Second Screeners of Titles and Abstracts in Systematic Reviews: A Proof of Concept and Common Guidelines. \url{https://osf.io/preprints/osf/yrhzm}

Thomas, J. et al. (2024). Responsible AI in Evidence SynthEsis (RAISE): guidance and recommendations. \url{https://osf.io/cn7x4}

Wickham H (2023). httr2: Perform HTTP Requests and Process the Responses. \url{https://httr2.r-lib.org}
}
